!function(e){"use strict";var t=bookmifyConfig;moment.updateLocale("en",{months:t.calendar.monthsLong,monthsShort:t.calendar.monthsShort,weekdays:t.calendar.daysLong,weekdaysShort:t.calendar.daysShort,weekdaysMin:t.calendar.daysShort});var a={page:1,search:"",order:"ASC",text:"",orderClass:"order_asc",servicesIDs:[],customerID:"",employeeID:"",status:"",dateRange:[t.appointmentStartDate,t.appointmentEndDate],startDate:moment(),endDate:moment().add(t.appointmentDateRange,"days"),oldStartDate:moment().format("YYYY-MM-DD")+" 00:00:00",oldEndDate:moment().add(t.appointmentDateRange,"days").format("YYYY-MM-DD")+" 23:59:59",oldSDate:moment(),oldEDate:moment().add(t.appointmentDateRange,"days"),newStartDate:"",newEndDate:""},i={div1:"",div2:"",div3:""},o={serviceDuration:0,serviceCapMin:"",serviceCapMax:"",extraDuration:0},n={cloneForm:e(".bookmify_be_content .bookmify_be_popup_form_wrap").clone()},s={iaoAlertTime:"5000",iaoAlertPosition:"bottom-right",alertSuccessIcon:'<span class="icon_holder success"><i class="xcon-ok"></i></span>',alertWarningIcon:'<span class="icon_holder warning"><i class="xcon-attention-alt"></i></span>',deletedText:'<span class="text">'+t.deletedText+"</span>",savedText:'<span class="text">'+t.savedText+"</span>",addedText:'<span class="text">'+t.addedText+"</span>",errorField:'<span class="error_note">'+t.errorField+"</span>",errorDelete:'<span class="error_note">'+t.errorDelete+"</span>",errorEdit:'<span class="error_note">'+t.errorEdit+"</span>",clearCapacity:"<label>"+t.clearCapacity+"</label>",filterStatus:[],filterAppointment:[],noRecords:t.noRecords,minCapacity:t.minCapacity,maxCapacity:t.maxCapacity,ajaxurl:t.ajaxUrl,momentDateFormat:t.momentDateFormat,longMonths:t.calendar.monthsLong,calendar:{monthsLong:t.calendar.monthsLong,monthsShort:t.calendar.monthsShort,daysLong:t.calendar.daysLong,daysShort:t.calendar.daysShort,firstDay:t.calendar.firstDay},cacheElements:function(){this.cache={allInputs:e('input[type="text"]'),allNano:e(".nano"),approvedIcon:e(".bookmify_be_hidden_info .approved_icon").html(),pendingIcon:e(".bookmify_be_hidden_info .pending_icon").html(),canceledIcon:e(".bookmify_be_hidden_info .canceled_icon").html(),rejectedIcon:e(".bookmify_be_hidden_info .rejected_icon").html(),personIcon:e(".bookmify_be_hidden_info .person_icon").html(),downIcon:e(".bookmify_be_hidden_info .down_icon").html(),info_remover:e(".bookmify_be_hidden_info .info_remover").html(),nothingFound:e(".bookmify_be_hidden_info .nothing_found").html(),CES:'<div class="bookmify_be_infobox danger"><label>'+e(".bookmify_be_hidden_info .select_cus_emp_ser").html()+"</label></div>",noExtras:e(".bookmify_be_hidden_info .no_extras").html(),filters:e(".bookmify_be_appointments .bookmify_be_appointments_filter"),allFilters:e(".bookmify_be_appointments .bookmify_be_filter_list"),filterDateRangeWrap:e(".bookmify_be_appointments .bookmify_be_filter_list.daterange"),filterReset:e(".bookmify_be_appointments .bookmify_be_filter_list.reset"),filterServiceList:e(".bookmify_be_appointments .bookmify_be_services_filter_list"),filterServiceWrap:e(".bookmify_be_appointments .bookmify_be_filter_list.services"),filterCustomerList:e(".bookmify_be_appointments .bookmify_be_filter_popup_list.customers"),filterCustomerWrap:e(".bookmify_be_appointments .bookmify_be_filter_list.customers"),filterEmployeeList:e(".bookmify_be_appointments .bookmify_be_filter_popup_list.employees"),filterEmployeeWrap:e(".bookmify_be_appointments .bookmify_be_filter_list.employees"),filterStatusList:e(".bookmify_be_appointments .bookmify_be_filter_popup_list.status"),filterStatusWrap:e(".bookmify_be_appointments .bookmify_be_filter_list.status")},this.filters={customerIDs:"",categoryID:"",serviceID:"",employeeID:"",locationID:""},this.cache.filterServiceInput=this.cache.filterServiceWrap.find(".filter_list"),this.cache.filterServiceInputPlaceholder=this.cache.filterServiceInput.attr("data-placeholder"),this.cache.filterCustomerInput=this.cache.filterCustomerWrap.find(".filter_list"),this.cache.filterCustomerInputPlaceholder=this.cache.filterCustomerInput.attr("data-placeholder"),this.cache.filterEmployeeInput=this.cache.filterEmployeeWrap.find(".filter_list"),this.cache.filterEmployeeInputPlaceholder=this.cache.filterEmployeeInput.attr("data-placeholder"),this.cache.filterStatusInput=this.cache.filterStatusWrap.find(".filter_list"),this.cache.filterStatusInputPlaceholder=this.cache.filterStatusInput.attr("data-placeholder")},init:function(){e(".bookmify_be_appointments").length&&(e(".bookmify_be_content .bookmify_be_popup_form_wrap").remove(),this.cacheElements(),this.imgToSvg(),this.openCloseAppointment(),this.openDetailsAppointment(),this.insertAppointment(),this.deleteAppointment(),this.doFilter(),this.bookmifyCheckVar(),e.protip())},bookmifyCheckVar:function(){},imgToSvg:function(){e("img.bookmify_be_svg").each(function(){var t=e(this),a=t.attr("class"),i=t.attr("src");e.get(i,function(i){var o=e(i).find("svg");void 0!==a&&(o=o.attr("class",a+" replaced-svg")),o=o.removeAttr("xmlns:a"),t.replaceWith(o)},"xml")})},doFilter:function(){var t=e(".bookmify_be_pagination.appointment li a"),i=this;t.off().on("click",function(t){t.preventDefault(),e(".bookmify_be_filter_list").removeClass("opened");var o=e(this),n=o.parent(),s=o.data("page"),r=0;return n.hasClass("prev")?(s=o.parent().parent().find("li.active a").data("page")-1,r=1):n.hasClass("next")&&(s=o.parent().parent().find("li.active a").data("page")+1,r=1),n.hasClass("active")||(a.page=s,i.filterAjaxCall()),1===r&&(a.page=s,i.filterAjaxCall()),!1}),i.cache.filterDateRangeWrap.find("input").daterangepicker({autoApply:!0,startDate:a.startDate,endDate:a.endDate,locale:{format:i.momentDateFormat,daysOfWeek:i.calendar.daysShort,monthNames:i.calendar.monthsLong,firstDay:parseInt(i.calendar.firstDay)}},function(e,t){a.dateRange=[],a.dateRange.push(e.format("YYYY-MM-DD")+" 00:00:00"),a.dateRange.push(t.format("YYYY-MM-DD")+" 23:59:59"),a.startDate=e,a.endDate=t,a.newStartDate=e.format("YYYY-MM-DD")+" 00:00:00",a.newEndDate=t.format("YYYY-MM-DD")+" 23:59:59",a.oldStartDate===a.newStartDate&&a.oldEndDate===a.newEndDate||i.cache.filterDateRangeWrap.hasClass("filtered")||(i.cache.filterDateRangeWrap.addClass("filtered"),i.cache.filters.addClass("filtered")),a.oldStartDate===a.newStartDate&&a.oldEndDate===a.newEndDate&&(i.cache.filterDateRangeWrap.removeClass("filtered"),i.cache.allFilters.hasClass("filtered")||i.cache.filters.removeClass("filtered")),i.filterAjaxCall()}),e(window).on("click",function(){i.cache.filterServiceWrap.removeClass("opened")}),i.cache.filterServiceWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterServiceWrap.addClass("opened")});var o=null;i.cache.filterServiceList.children("div").off().on("click",function(){var t=e(this),n=t.data("id");return t.hasClass("sending")?(t.removeClass("sending"),a.servicesIDs=e.grep(a.servicesIDs,function(e){return e!==n})):(t.addClass("sending"),a.servicesIDs.push(n)),clearTimeout(o),i.checkNewValueForServiceFilterInEmployee(),o=setTimeout(function(){a.page=1,i.cache.filterServiceWrap.addClass("filtered"),i.cache.filters.addClass("filtered"),i.filterAjaxCall(),a.servicesIDs.length||(i.cache.filterServiceWrap.removeClass("filtered"),i.cache.allFilters.hasClass("filtered")||i.cache.filters.removeClass("filtered")),i.cache.filterServiceWrap.removeClass("opened")},700),!1}),i.cache.filterServiceWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterServiceInput.attr("placeholder",i.cache.filterServiceInputPlaceholder),i.cache.filterServiceInput.siblings(".bookmify_be_new_value").html(""),i.cache.filterServiceWrap.removeClass("ready"),i.cache.filterServiceList.children("div").removeClass("sending"),a.servicesIDs=[],i.cache.filterServiceWrap.removeClass("opened"),i.cache.filterServiceWrap.removeClass("filtered"),i.cache.allFilters.hasClass("filtered")||i.cache.filters.removeClass("filtered"),i.filterAjaxCall()}),e(window).on("click",function(){i.cache.filterCustomerWrap.removeClass("opened")}),i.cache.filterCustomerWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterServiceWrap.removeClass("opened"),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterCustomerWrap.addClass("opened")}),i.cache.filterCustomerInput.off().on("keyup",function(){var t,a,o=e(this).val().toUpperCase(),n=i.cache.filterCustomerList.children(),s=n.children("div.item"),r=0,l=n.find(".no_records");for(""!==o?i.cache.filterCustomerWrap.addClass("ready clear"):i.cache.filterCustomerWrap.removeClass("ready clear"),a=0;a<s.length;a++)((t=s[a].getElementsByTagName("span")[0]).textContent||t.innerText).toUpperCase().indexOf(o)>-1?(s[a].style.display="",r--):(s[a].style.display="none",r++);r!==s.length||l.length?r!==s.length&&n.find(".no_records").remove():n.append('<div class="no_records"><span>'+i.noRecords+"</span></div>")}),i.cache.filterCustomerList.children().children("div").off().on("click",function(){var t=e(this),o=t.data("id"),n=t.find("span").html();return t.hasClass("sending")||(t.addClass("sending"),a.customerID=o,t.siblings().removeClass("sending"),i.cache.filterCustomerInput.attr("placeholder",""),i.cache.filterCustomerInput.attr("value",n),i.cache.filterCustomerWrap.addClass("ready"),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterCustomerWrap.addClass("filtered"),i.cache.filters.addClass("filtered"),a.page=1,i.filterAjaxCall()),!1}),i.cache.filterCustomerWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterServiceWrap.removeClass("opened"),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterCustomerInput.attr("placeholder",i.cache.filterCustomerInputPlaceholder),i.cache.filterCustomerInput.attr("value",""),i.cache.filterCustomerList.children().children("div").removeClass("sending").css("display",""),""!==a.customerID?(a.customerID="",i.filterAjaxCall(),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterCustomerWrap.removeClass("filtered"),i.cache.allFilters.hasClass("filtered")||i.cache.filters.removeClass("filtered")):i.cache.filterCustomerInput.frenifyMoveCursorToEnd(),i.cache.filterCustomerWrap.removeClass("ready"),i.cache.filterCustomerWrap.removeClass("clear"),i.cache.filterCustomerList.children().find(".no_records").remove()}),e(window).on("click",function(){i.cache.filterEmployeeWrap.removeClass("opened")}),i.cache.filterEmployeeWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterServiceWrap.removeClass("opened"),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterEmployeeWrap.addClass("opened")}),i.cache.filterEmployeeInput.off().on("keyup",function(){var t,a,o=e(this).val().toUpperCase(),n=i.cache.filterEmployeeList.children(),s=n.children("div.item"),r=0,l=n.find(".no_records");for(""!==o?i.cache.filterEmployeeWrap.addClass("ready clear"):i.cache.filterEmployeeWrap.removeClass("ready clear"),a=0;a<s.length;a++)((t=s[a].getElementsByTagName("span")[0]).textContent||t.innerText).toUpperCase().indexOf(o)>-1?(s[a].style.display="",r--):(s[a].style.display="none",r++);r!==s.length||l.length?r!==s.length&&n.find(".no_records").remove():n.append('<div class="no_records"><span>'+i.noRecords+"</span></div>")}),i.cache.filterEmployeeList.children().children("div").off().on("click",function(){var t=e(this),o=t.data("id"),n=t.find("span").html();return t.hasClass("sending")||(t.addClass("sending"),a.employeeID=o,t.siblings().removeClass("sending"),i.cache.filterEmployeeInput.attr("placeholder",""),i.cache.filterEmployeeInput.attr("value",n),i.cache.filterEmployeeWrap.addClass("ready"),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterEmployeeWrap.addClass("filtered"),i.cache.filters.addClass("filtered"),a.page=1,i.filterAjaxCall()),!1}),i.cache.filterEmployeeWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterServiceWrap.removeClass("opened"),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterEmployeeInput.attr("placeholder",i.cache.filterEmployeeInputPlaceholder),i.cache.filterEmployeeInput.attr("value",""),i.cache.filterEmployeeList.children().children("div").removeClass("sending").css("display",""),""!==a.employeeID?(a.employeeID="",i.filterAjaxCall(),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterEmployeeWrap.removeClass("filtered"),i.cache.allFilters.hasClass("filtered")||i.cache.filters.removeClass("filtered")):i.cache.filterEmployeeInput.frenifyMoveCursorToEnd(),i.cache.filterEmployeeWrap.removeClass("ready"),i.cache.filterEmployeeWrap.removeClass("clear"),i.cache.filterEmployeeWrap.children().find(".no_records").remove()}),e(window).on("click",function(){i.cache.filterStatusWrap.removeClass("opened")}),i.cache.filterStatusWrap.on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterServiceWrap.removeClass("opened"),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterStatusWrap.addClass("opened")}),i.cache.filterStatusInput.off().on("keyup",function(){var t,a,o=e(this).val().toUpperCase(),n=i.cache.filterStatusList.children(),s=n.children("div.item"),r=0,l=n.find(".no_records");for(""!==o?i.cache.filterStatusWrap.addClass("ready clear"):i.cache.filterStatusWrap.removeClass("ready clear"),a=0;a<s.length;a++)((t=s[a].getElementsByTagName("span")[0]).textContent||t.innerText).toUpperCase().indexOf(o)>-1?(s[a].style.display="",r--):(s[a].style.display="none",r++);r!==s.length||l.length?r!==s.length&&n.find(".no_records").remove():n.append('<div class="no_records"><span>'+i.noRecords+"</span></div>")}),i.cache.filterStatusList.children().children("div").off().on("click",function(){var t=e(this),o=t.data("status"),n=t.find("span").html();return t.hasClass("sending")||(t.addClass("sending"),a.status=o,t.siblings().removeClass("sending"),i.cache.filterStatusInput.attr("placeholder",""),i.cache.filterStatusInput.attr("value",n),i.cache.filterStatusWrap.addClass("ready"),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterStatusWrap.addClass("filtered"),i.cache.filters.addClass("filtered"),a.page=1,i.filterAjaxCall()),!1}),i.cache.filterStatusWrap.find(".icon").off().on("click",function(e){e.preventDefault(),e.stopPropagation(),i.cache.filterServiceWrap.removeClass("opened"),i.cache.filterCustomerWrap.removeClass("opened"),i.cache.filterEmployeeWrap.removeClass("opened"),i.cache.filterStatusInput.attr("placeholder",i.cache.filterStatusInputPlaceholder),i.cache.filterStatusInput.attr("value",""),i.cache.filterStatusList.children().children("div").removeClass("sending").css("display",""),""!==a.status?(a.status="",i.filterAjaxCall(),i.cache.filterStatusWrap.removeClass("opened"),i.cache.filterStatusWrap.removeClass("filtered"),i.cache.allFilters.hasClass("filtered")||i.cache.filters.removeClass("filtered")):i.cache.filterStatusInput.frenifyMoveCursorToEnd(),i.cache.filterStatusWrap.removeClass("ready"),i.cache.filterStatusWrap.removeClass("clear"),i.cache.filterStatusWrap.children().find(".no_records").remove()}),i.cache.filterReset.find("a").off().on("click",function(e){return e.preventDefault(),e.stopPropagation(),!!i.cache.filters.hasClass("filtered")&&(a.page=1,a.servicesIDs=[],a.customerID="",a.employeeID="",a.status="",a.dateRange=[],a.dateRange.push(a.oldStartDate),a.dateRange.push(a.oldEndDate),a.startDate=a.oldSDate,a.endDate=a.oldEDate,i.cache.filterDateRangeWrap.find("input").data("daterangepicker").setStartDate(a.oldSDate),i.cache.filterDateRangeWrap.find("input").data("daterangepicker").setEndDate(a.oldEDate),i.cache.filterDateRangeWrap.removeClass("filtered"),i.cache.allFilters.removeClass("filtered"),i.cache.allFilters.removeClass("opened ready clear"),i.cache.filterStatusInput.attr("placeholder",i.cache.filterStatusInputPlaceholder),i.cache.filterStatusInput.attr("value",""),i.cache.filterStatusList.children().children("div").removeClass("sending").css("display",""),i.cache.filterCustomerInput.attr("placeholder",i.cache.filterCustomerInputPlaceholder),i.cache.filterCustomerInput.attr("value",""),i.cache.filterCustomerList.children().children("div").removeClass("sending").css("display",""),i.cache.filterEmployeeInput.attr("placeholder",i.cache.filterEmployeeInputPlaceholder),i.cache.filterEmployeeInput.attr("value",""),i.cache.filterEmployeeList.children().children("div").removeClass("sending").css("display",""),i.cache.filterServiceInput.attr("placeholder",i.cache.filterServiceInputPlaceholder),i.cache.filterServiceInput.siblings(".bookmify_be_new_value").html(""),i.cache.filterServiceWrap.removeClass("ready"),i.cache.filterServiceList.children("div").removeClass("sending"),i.filterAjaxCall(),i.cache.filters.removeClass("filtered"),!1)})},checkNewValueForServiceFilterInEmployee:function(){if(e.isEmptyObject(a.servicesIDs))this.cache.filterServiceInput.attr("placeholder",this.cache.filterServiceInputPlaceholder),this.cache.filterServiceInput.siblings(".bookmify_be_new_value").html(""),this.cache.filterServiceWrap.removeClass("ready");else{var t="";if(this.cache.filterServiceInput.attr("placeholder",""),a.servicesIDs.length>1){var i=this.cache.filterServiceList.children("div").length;t='<span class="number">'+a.servicesIDs.length+" / "+i+"</span>"}var o='<span class="text">'+this.cache.filterServiceList.find('div[data-id="'+a.servicesIDs[0]+'"]').html()+"</span>";this.cache.filterServiceInput.siblings(".bookmify_be_new_value").html("").html(o+t),this.cache.filterServiceWrap.addClass("ready")}},filterAjaxCall:function(){var t=this,i={action:"ajaxFilterAppointmentList",bookmify_page:a.page,bookmify_search:a.search,bookmify_services:a.servicesIDs,bookmify_customer:a.customerID,bookmify_employee:a.employeeID,bookmify_status:a.status,bookmify_daterange:a.dateRange};e.ajax({type:"POST",url:t.ajaxurl,cache:!0,data:i,success:function(e){t.getFilteredAppointmentsList(e)},error:function(){}})},getFilteredAppointmentsList:function(t){var a=e.parseJSON(t),i=e(".bookmify_be_appointments_list");i.html(a.bookmify_be_data);var o=i.find(".bookmify_be_list_item");setTimeout(function(){o.each(function(t,a){setTimeout(function(){e(a).addClass("fadeInTop done")},100*t)})},150),this.init()},miniStatusForAppointments:function(t){var a=this,i=t.find(".bookmify_be_ministatus");i.find(".label").off().on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked");var t=e(this).closest(".bookmify_be_ministatus");return i.hasClass("opened")?t.hasClass("opened")?t.removeClass("opened"):(i.removeClass("opened"),t.addClass("opened")):t.addClass("opened"),!1}),i.find(".ministatus_dd div").on("click",function(){var i=e(this),o=i.closest(".bookmify_be_ministatus"),n=i.attr("class");o.find("label").attr("class",n).html(i.find("span").html()),o.removeClass("opened");var s=i.closest(".item").data("customer-id");return t.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+s+'"]').removeClass("item_approved item_pending item_canceled item_rejected").addClass("item_"+n),a.calcExtraPayment(),a.saveAppointment(),!1}),i.find(".ministatus_dd").on("click",function(e){e.stopPropagation()}),e(window).on("click",function(){i.removeClass("opened")})},numberOfPeopleForAppointments:function(){var t=e(".nano.number_list"),a=e("body > .bookmify_be_popup_form_appointment .ad_customer_list_with_info .detail_holder .no_people input"),i=this;a.off().on("click",function(a){a.preventDefault(),a.stopPropagation();var o=e(this);o.hasClass("input_clicked")?(o.removeClass("input_clicked"),t.removeClass("focused")):(e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("*:not(.no_people) input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),o.addClass("input_clicked"),t.addClass("focused"),t.css({width:o.outerWidth()+"px"}),new Popper(o,t,{placement:"bottom-start",onUpdate:function(){t.css({width:o.outerWidth()+"px"})}})),i.clickOnNumberList(t)}),i.clickOnNumberList(t),e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")})},clickOnNumberList:function(t){var a=this;t.find(".nano-content > div").off().on("click",function(t){t.preventDefault(),t.stopPropagation();var i=e(this).html(),o=e("body > .bookmify_be_popup_form_appointment"),n=o.find(".no_people input.input_clicked"),s=n.closest(".item").data("customer-id");return e(this).hasClass("nodata")||(o.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+s+'"] input[name="people_count"]').val(i),n.val(i),a.calcExtraPayment()),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),!1})},removeCustomerItemForAppointment:function(){var t=this,a=e("body > .bookmify_be_popup_form_appointment .ad_customer_list_with_info .item .detail_holder .remover > span"),i=e(".nano.app_customers");a.off().on("click",function(a){a.preventDefault(),a.stopPropagation(),e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked");var o=e(this),n=o.closest(".item"),s=o.closest(".bookmify_be_ad_customers"),r=n.data("customer-id"),l=s.find('[name="customer_ids"]').val().split(",");l=e.grep(l,function(e){return e!==r.toString()});var c="";e.each(l,function(e,t){c+=t,c+=","}),c=c.slice(0,-1);var p=s.find('input[name="customer"]'),d=c.split(","),m=p.attr("data-placeholder");if(""!==c){var f="";if(p.attr("placeholder",""),d.length>1){var u=i.find("ul.customers_nano_list li").length;f='<span class="number">'+d.length+" / "+u+"</span>"}var _='<span class="text">'+i.find("input[value="+d[0]+"]").closest("li").find("span.name").html()+"</span>";p.siblings(".bookmify_be_new_value").html("").html(_+f)}else p.attr("placeholder",m),p.siblings(".bookmify_be_new_value").html("");p.siblings('input[name="customer_ids"]').val("").val(d);var v=[];return e("body > .bookmify_be_popup_form_appointment .ad_customer_list_with_info .item").each(function(){var t=e(this),a=t.data("customer-id"),i=t.find('input[name="number_of_people"]').val();r!=a&&(v[a]=i)}),t.removeExtraAndPayment(r),n.remove(),!1})},popperCustomersForAppointments:function(){var t=e(".nano.app_customers"),a=e('body > .bookmify_be_popup_form_appointment input[name="customer"]'),i=t.find('input[type="checkbox"]'),o=this;a.off().on("click",function(n){n.stopPropagation();var s=a.siblings('[name="customer_ids"]').val().split(",");i.prop("checked",!1),e.each(s,function(e,a){t.find('input[type="checkbox"][value="'+a+'"]').prop("checked",!0)}),t=e(".nano.app_customers"),a.hasClass("input_clicked")?(a.removeClass("input_clicked"),t.removeClass("focused")):(e(".nano:not(.app_customers)").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("*:not(.customer) input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),a.addClass("input_clicked"),t.addClass("focused"),t.css({width:a.outerWidth()+"px"}),new Popper(a,t,{placement:"bottom-start",onUpdate:function(){t.css({width:a.outerWidth()+"px"})}})),o.clickOnCustomer(a,i,t)}),e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),t.on("click",function(e){e.stopPropagation()}),o.checkCustomerIDs(a),o.clearCustomerInput(a,i)},checkCustomerIDs:function(e){var t=e.siblings('input[name="customer_ids"]'),a=e.siblings(".bot_btn");" "===t.val()||""===t.val()?a.removeClass("opened"):a.addClass("opened")},clearCustomerInput:function(t,a){var i=t.attr("data-placeholder"),o=t.siblings(".bot_btn"),n=this;o.off().on("click",function(){return t.siblings('[name="customer_ids"]').val(""),t.siblings(".bookmify_be_new_value").html(""),a.prop("checked",!1),t.attr("placeholder",i),o.removeClass("opened"),t.closest(".bookmify_be_ad_customers").find(".ad_customer_list_with_info").html(""),e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),n.removeExtraAndPayment("destroy"),!1})},clickOnCustomer:function(t,a,i){var o=this;i.find("ul.customers_nano_list li").off().on("click",function(){var n=e(this),s=n.find('input[type="checkbox"]');s.is(":checked")?s.prop("checked",!1):s.prop("checked",!0),o.checkCustomerIDs(t),o.clickOnCustomerAction(t,i,a,n),o.clearCustomerInput(t,a),o.calcExtraPayment(),t.parent().removeClass("required_error"),t.parent().find(".error_note").remove()})},clickOnCustomerAction:function(t,a,i,o){var n=this,s=[];a.find("ul.customers_nano_list li").each(function(){var t=e(this),a=t.find('input[name="customer_id"]').val();t.find('input[type="checkbox"]').is(":checked")?(s=e.grep(s,function(e){return e!==a}),t.addClass("checked"),s.push(t.find('input[name="customer_id"]').val())):(t.removeClass("checked"),s=e.grep(s,function(e){return e!==a}))});var r=s,l=s,c=t.attr("data-placeholder");if(e.isEmptyObject(s))t.attr("placeholder",c),t.siblings(".bookmify_be_new_value").html("");else{var p="";if(t.attr("placeholder",""),s.length>1){var d=a.find("ul.customers_nano_list li").length;p='<span class="number">'+s.length+" / "+d+"</span>"}var m='<span class="text">'+a.find("input[value="+s[0]+"]").closest("li").find("span.name").html()+"</span>";t.siblings(".bookmify_be_new_value").html("").html(m+p)}t.parent().find('input[name="customer_ids"]').val("").val(s),n.filters.customerIDs=s;var f=t.closest(".bookmify_be_ad_customers").find(".ad_customer_list_with_info"),u=f.find(".item"),_=[];u.each(function(){_.push(e(this).data("customer-id"))});var v=[];e.each(_,function(t,a){-1===s.indexOf(a.toString())?v.push(a):s=e.grep(s,function(e){return e!=a})}),e.each(v,function(e,t){f.find('.item[data-customer-id="'+t+'"]').remove()}),e.each(s,function(t,a){var i=e('ul.customers_nano_list input[type="checkbox"][value="'+a+'"]').siblings('input[name="full_name"]').val(),o=e('ul.customers_nano_list input[type="checkbox"][value="'+a+'"]').siblings('input[name="email"]').val(),s='<div class="detail_holder">'+('<div class="status"><div class="bookmify_be_ministatus"><div class="label"><label class="approved">'+n.cache.approvedIcon+'</label></div><div class="ministatus_dd"><div class="approved"><span>'+n.cache.approvedIcon+'</span></div><div class="pending"><span>'+n.cache.pendingIcon+'</span></div><div class="canceled"><span>'+n.cache.canceledIcon+'</span></div><div class="rejected"><span>'+n.cache.rejectedIcon+"</span></div></div></div></div>")+('<div class="no_people"><span class="person_icon">'+n.cache.personIcon+'</span><span class="down_icon">'+n.cache.downIcon+'</span><input type="number" readonly value="1" /></div>')+n.cache.info_remover+"</div>";f.append('<div class="item" data-customer-id="'+a+'"><div class="name_holder"><span class="name">'+i+'</span><span clas="email">'+o+"<span></div>"+s+"</div>")});var h=t.closest(".bookmify_be_appointmentstabs_content").find(".bookmify_be_appointment_extras"),b=h.find(".bookmify_be_extras_customer_appointment"),y=[];b.each(function(){y.push(e(this).data("customer-id"))});var C=[];e.each(y,function(t,a){-1===r.indexOf(a.toString())?C.push(a):r=e.grep(r,function(e){return e!=a})}),e.each(C,function(e,t){h.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+t+'"]').remove()});var k="";e.each(l,function(e,t){k+=t,k+=","}),k=k.slice(0,-1);var g=[];e("body > .bookmify_be_popup_form_appointment .ad_customer_list_with_info .item").each(function(){var t=e(this),a=t.data("customer-id"),i=t.find('input[name="number_of_people"]').val();g[a]=i});var x=t.closest(".bookmify_be_popup_form_appointment"),D=x.find('input[name="employee_id"]').val(),I=x.find('input[name="service_id"]').val(),w=o.find('[name="customer_id"]').val(),A=o.find('[name="full_name"]').val(),P=o.find('[name="email"]').val(),S=o.find('[name="customer_id"]').is(":checked");n.addExtraAndPayment(w,A,P,S,D,I),n.imgToSvg(),n.numberOfPeopleForAppointments(),n.miniStatusForAppointments(x),n.removeCustomerItemForAppointment(),n.checkCustomerIDs(t)},categoryPopperForAppointment:function(){var t=e(".nano.category_list"),a=e('body > .bookmify_be_popup_form_appointment .category_wrap input[type="text"]'),i=this;a.each(function(){var a=e(this),o=a.closest(".bookmify_be_popup_form_appointment"),n=a.parent().find(".bot_btn");e(window).on("click",function(){t.removeClass("focused"),i.cache.allInputs.removeClass("input_clicked")}),t.on("click",function(e){e.stopPropagation()}),a.off().on("click",function(i){i.stopPropagation(),t.css({width:a.outerWidth()+"px"}),a.hasClass("input_clicked")?(a.removeClass("input_clicked"),t.removeClass("focused")):(e(".nano:not(.category_list)").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("*:not(.category_wrap) input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),a.addClass("input_clicked"),t.addClass("focused"),new Popper(a,t,{placement:"bottom-start",onUpdate:function(){t.css({width:a.outerWidth()+"px"})}}))}),t.css({width:a.outerWidth()+"px"}),t.find(".nano-content > div").on("click",function(t){t.stopPropagation();var s=e(this).html(),r=e(this).data("category-id");0===r?a.val(""):a.val(s),a.parent().find('input[type="hidden"]').val(r),i.checkFourInputsAppointments(o),i.checkCategoryID(a,n),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),n.on("click",function(){a.val(""),a.parent().find('input[type="hidden"]').val(""),i.checkFourInputsAppointments(o),n.removeClass("opened"),e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked")}),i.checkCategoryID(a,n)})},checkCategoryID:function(e,t){" "===e.val()||""===e.val()?t.removeClass("opened"):t.addClass("opened")},servicePopperForAppointment:function(){var t=this,a=e(".nano.service_list"),i=e(".nano.category_list .nano-content > div"),n=e('body > .bookmify_be_popup_form_appointment .service_wrap input[type="text"]');n.each(function(){var s=e(this),r=s.closest(".bookmify_be_popup_form_appointment"),l=r.find('input[name="category_id"]'),c=l.val(),p=l.siblings("span.bot_btn");e(window).on("click",function(){a.removeClass("focused"),t.cache.allInputs.removeClass("input_clicked")}),a.on("click",function(e){e.stopPropagation()}),s.off().on("click",function(t){t.stopPropagation(),t.preventDefault(),a.css({width:s.outerWidth()+"px"}),s.hasClass("input_clicked")?(s.removeClass("input_clicked"),a.removeClass("focused")):(e(".nano:not(.service_list)").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("*:not(.service_wrap) input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),s.addClass("input_clicked"),a.addClass("focused"),new Popper(s,a,{placement:"bottom-start",onUpdate:function(){a.css({width:s.outerWidth()+"px"})}}))}),a.css({width:s.outerWidth()+"px"}),a.find(".nano-content > div").on("click",function(a){a.stopPropagation();var o=e(this).html(),d=e(this).data("service-id");if(0===d?s.val(""):s.val(o),s.parent().find('input[type="hidden"]').val(d),""!==d&&""===c){var f=","+d+",";i.each(function(){var t=e(this),a=","+t.data("service-id")+",";t.addClass("disabled"),a.includes(f)&&(t.removeClass("disabled"),l.val(t.data("category-id")),l.siblings('input[type="text"]').val(t.html()),p.addClass("opened"))})}var u=r.find('input[name="customer_ids"]').val(),_=r.find('input[name="employee_id"]').val(),v=r.find(".ad_customer_list_with_info .item"),h=[];v.each(function(){var t=e(this).data("customer-id"),a=e(this).find("input").val(),i=e(this).find(".bookmify_be_ministatus .label label").attr("class");h.push([t,a,i])}),n.closest(".bookmify_be_appointment_details").find(".time_wrap .required_field").val(""),n.closest(".bookmify_be_appointment_details").find(".time_wrap .bot_btn").removeClass("opened"),t.reBuildExtrasAppointment(u,d,_,r,h),t.reBuildPaymentsAppointment(u,d,_,r,h),t.checkFourInputsAppointments(r),t.checkValuesServiceEmployeeDateForTimeSlots(r),t.changeContentOfPopupNumberOfPeopleForAppointment(r),m(),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),s.parent().removeClass("required_error"),s.parent().find(".error_note").remove()});var d=s.parent().find(".bot_btn");function m(){" "===s.val()||""===s.val()?d.removeClass("opened"):d.addClass("opened")}d.on("click",function(){s.val(""),s.parent().find('input[type="hidden"]').val(""),e('body > .bookmify_be_popup_form_appointment .category_wrap input[type="text"]').val(""),e('body > .bookmify_be_popup_form_appointment .category_wrap input[type="text"]').parent().find('input[type="hidden"]').val(""),e('body > .bookmify_be_popup_form_appointment .category_wrap input[type="text"]').parent().find(".bot_btn").removeClass("opened"),t.checkFourInputsAppointments(r),d.removeClass("opened"),o.serviceCapMax="",o.serviceCapMin="",t.callAlertBoxCapacity(),t.removeExtraAndPayment("destroy"),t.changeContentOfPopupNumberOfPeopleForAppointment(r),e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked")}),m()})},employeePopperForAppointment:function(){var t=this,a=e(".nano.employee_list"),i=e(".nano.location_list .nano-content > div"),n=e('body > .bookmify_be_popup_form_appointment .employee_wrap input[type="text"]');n.each(function(){var s=e(this),r=s.closest(".bookmify_be_popup_form_appointment"),l=r.find('input[name="location_id"]'),c=l.val(),p=l.siblings("span.bot_btn"),d=r.find('input[name="appointment_day"]');e(window).on("click",function(){a.removeClass("focused"),t.cache.allInputs.removeClass("input_clicked")}),a.on("click",function(e){e.stopPropagation()}),s.on("click",function(t){t.stopPropagation(),a.css({width:s.outerWidth()+"px"}),s.hasClass("input_clicked")?(s.removeClass("input_clicked"),a.removeClass("focused")):(e(".nano:not(.employee_list)").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("*:not(.employee_wrap) input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),s.addClass("input_clicked"),a.addClass("focused"),new Popper(s,a,{placement:"bottom-start",onUpdate:function(){a.css({width:s.outerWidth()+"px"})}}))}),a.css({width:s.outerWidth()+"px"}),a.find(".nano-content > div").on("click",function(a){a.stopPropagation();var o=e(this).html(),m=e(this).data("employee-id");if(0===m?s.val(""):s.val(o),s.siblings('input[type="hidden"]').val(m),""!==m&&""===c){var u=","+m+",";i.each(function(){var t=e(this),a=","+t.data("employee-id")+",";t.addClass("disabled"),a.includes(u)&&(t.removeClass("disabled"),l.val(t.data("location-id")),l.siblings('input[type="text"]').val(t.html()),p.addClass("opened"))})}n.closest(".bookmify_be_appointment_details").find(".time_wrap .required_field").val(""),n.closest(".bookmify_be_appointment_details").find(".time_wrap .bot_btn").removeClass("opened"),t.multiDatesPickerAppointment(),t.getDaysOffEmployeeForAppointment(m,d);var _=r.find('input[name="customer_ids"]').val(),v=m,h=r.find('input[name="service_id"]').val(),b=r.find(".ad_customer_list_with_info .item"),y=[];b.each(function(){var t=e(this).data("customer-id"),a=e(this).find("input").val(),i=e(this).find(".bookmify_be_ministatus .label label").attr("class");y.push([t,a,i])}),t.reBuildExtrasAppointment(_,h,v,r,y),t.reBuildPaymentsAppointment(_,h,v,r,y),t.checkFourInputsAppointments(r),t.checkValuesServiceEmployeeDateForTimeSlots(r),t.changeContentOfPopupNumberOfPeopleForAppointment(r),f(),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),s.parent().removeClass("required_error"),s.parent().find(".error_note").remove()});var m=s.parent().find(".bot_btn");function f(){" "===s.val()||""===s.val()?m.removeClass("opened"):m.addClass("opened")}m.on("click",function(){s.val(""),s.parent().find('input[type="hidden"]').val(""),t.checkFourInputsAppointments(r),m.removeClass("opened"),t.removeExtraAndPayment("destroy"),o.serviceCapMax="",o.serviceCapMin="",t.callAlertBoxCapacity(),t.checkFourInputsAppointments(r),e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked")}),f()})},locationPopperForAppointment:function(){var t=e(".nano.location_list"),a=e('body > .bookmify_be_popup_form_appointment .location_wrap input[type="text"]'),i=this;a.each(function(){var a=e(this),o=a.closest(".bookmify_be_popup_form_appointment");e(window).on("click",function(){t.removeClass("focused"),i.cache.allInputs.removeClass("input_clicked")}),t.on("click",function(e){e.stopPropagation()}),a.on("click",function(i){i.stopPropagation(),t.css({width:a.outerWidth()+"px"}),a.hasClass("input_clicked")?(a.removeClass("input_clicked"),t.removeClass("focused")):(e(".nano:not(.location_list)").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("*:not(.location_wrap) input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),a.addClass("input_clicked"),t.addClass("focused"),new Popper(a,t,{placement:"bottom-start",onUpdate:function(){t.css({width:a.outerWidth()+"px"})}}))}),t.css({width:a.outerWidth()+"px"}),t.find(".nano-content > div").on("click",function(t){t.stopPropagation();var n=e(this).html(),r=e(this).data("location-id");0===r?a.val(""):a.val(n),a.parent().find('input[type="hidden"]').val(r),i.checkFourInputsAppointments(o),s(),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")});var n=a.parent().find(".bot_btn");function s(){" "===a.val()||""===a.val()?n.removeClass("opened"):n.addClass("opened")}n.on("click",function(){a.val(""),a.parent().find('input[type="hidden"]').val(""),i.checkFourInputsAppointments(o),n.removeClass("opened"),e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked")}),s()})},openCloseAppointment:function(){var t=e(".bookmify_appointment_heading a.bookmify_be_edit"),a=this;t.off().on("click",function(){var t=e(this),i=t.closest(".bookmify_be_appointment_item");if(i.hasClass("bookmify_be_closed_item")||t.parent().hasClass("bookmify_be_closed_btn"))return!1;if(i.hasClass("bookmify_be_open_item")&&t.parent().hasClass("bookmify_be_open_btn")){var o=i.data("entity-id"),n=i.find('input[name="appointment_day"]'),s=i.find('input[name="employee_id"]').val(),r={action:"ajaxQueryEditAppointment",bookmify_data:o};return t.hasClass("loading")||(t.addClass("loading"),i.addClass("loading"),e.ajax({type:"POST",url:a.ajaxurl,cache:!1,data:r,success:function(o){"warning"===e.parseJSON(o).bookmify_be_data?(t.removeClass("loading"),i.removeClass("loading"),e.iaoAlert({msg:a.alertWarningIcon+a.errorEdit,type:"success",alertTime:a.iaoAlertTime,position:a.iaoAlertPosition})):(t.removeClass("loading"),i.removeClass("loading"),a.getRequestedAppointmentPopup(o,i,s,n))},error:function(){}})),!1}})},getRequestedAppointmentPopup:function(t,a,n,s){var r=this,l=e.parseJSON(t),c=l.bookmify_be_data;e("body").addClass("disable_scroll").append(c),e("body > .bookmify_be_popup_form_wrap").addClass("bookmify_be_popup_form_appointment"),s=(a=e("body > .bookmify_be_popup_form_appointment")).find('input[name="appointment_day"]'),n=a.find('input[name="employee_id"]').val(),r.imgToSvg(),r.universalTab(),r.checkFourInputsAppointments(a),r.popperCustomersForAppointments(),r.miniStatusForAppointments(a),r.categoryPopperForAppointment(),r.servicePopperForAppointment(),r.employeePopperForAppointment(),r.locationPopperForAppointment(),r.numberOfPeopleForAppointments(),r.appointmentTimePopper(),r.extraQuantity(),r.enableDisableExtraForCustomerInAppointments(),r.doFilter(),i.div1=l.buffy2,i.div2=l.buffy3,i.div3=l.buffy4,o.serviceDuration=parseInt(a.find("input.service_duration").val()),o.serviceCapMax=parseInt(a.find("input.service_max").val()),o.serviceCapMin=parseInt(a.find("input.service_min").val()),a.find("input.service_duration").remove(),a.find("input.service_max").remove(),a.find("input.service_min").remove(),r.changeContentOfPopupNumberOfPeopleForAppointment(a),o.extraDuration=0,r.calculateExtrasDuration(),r.multiDatesPickerAppointment(),r.removeDateFromAppointment(),r.removeCustomerItemForAppointment(),""!==n&&(r.getDaysOffEmployeeForAppointment(n,s),r.removeDateFromAppointment(),r.appointmentTimePopper()),r.cancelItem(),r.saveAppointment(),setTimeout(function(){e("body > .bookmify_be_popup_form_wrap").addClass("enable"),r.closersPopup()},10)},calculateExtrasDuration:function(t){var a=e("body > .bookmify_be_popup_form_appointment"),i=a.find(".bookmify_extra_service_item_app"),n=0,s=[];i.each(function(){var t=e(this),a=t.find(".req"),i=parseFloat(t.data("id")),o=t.closest(".bookmify_be_extras_customer_appointment"),n=parseFloat(t.find(".extra_duration").val()),r=parseFloat(t.find('input[name="extra_quantity"]').val());(o.hasClass("item_approved")||o.hasClass("item_pending"))&&a.is(":checked")&&(void 0===s[i]||s[i]<n*r)&&(s[i]=n*r)}),s=s.filter(function(e){return null!=e}),e.each(s,function(e,t){n+=t}),"remove"===t&&o.extraDuration!==n&&(o.extraDuration=n,this.checkValuesServiceEmployeeDateForTimeSlots(a,t)),o.extraDuration=n},universalTab:function(){e(".bookmify_be_tab_wrap").each(function(){var t=e(this);t.find("a.bookmify_be_tab_link").on("click",function(){e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked");var a=e(this).parent(),i=a.index();return a.siblings("li").removeClass("active"),a.addClass("active"),t.find(".bookmify_be_tab_pane").removeClass("active"),e(t.find(".bookmify_be_tab_pane")[i]).addClass("active"),!1})})},closerButton:function(){var t=this;e(".bookmify_be_popup_form_wrap.enable").find("span.closer").on("click",function(){t.closePopupForm()})},closerEsc:function(){var t=this;e(document).keyup(function(e){"Escape"===e.key&&t.closePopupForm()})},closersPopup:function(){this.closerEsc(),this.closerButton()},closePopupForm:function(){var t=e(".bookmify_be_popup_form_wrap.enable");e("body").removeClass("disable_scroll"),t.removeClass("enable"),setTimeout(function(){t.remove()},300)},getDaysOffEmployeeForAppointment:function(t,a){var i=this;a.closest(".day_wrap").addClass("waiting");var o={action:"ajaxQuerydayOffsEmployee",bookmify_employee_id:t};e.ajax({type:"POST",url:i.ajaxurl,cache:!1,data:o,success:function(e){i.employeeDayOffsAjaxProcess(e,a),a.closest(".day_wrap").removeClass("waiting")},error:function(){}})},employeeDayOffsAjaxProcess:function(t,a){var i=e.parseJSON(t),o=new Date,n=o.getHours(),s=o.getMinutes(),r=0,l=parseFloat(e(".bookmify_be_mintime_tobooking input").val()),c=parseFloat(e(".bookmify_be_maxtime_tobooking input").val());l<1?(s+=60*l)>60&&n++:l>=1&&l<24?(n+=l)>=24&&(r="+1d"):r="+"+l/24+"d";var p=i.bookmify_be_time,d=[];e.each(p,function(e,t){7===t&&(t=0),d.push(t)}),a.datepicker("option",{minDate:r,setDate:null,beforeShowDay:function(t){var a=e.datepicker.formatDate("yy-mm-dd",t),o=e.datepicker.formatDate("mm-dd",t),n=t.getDay();return[-1===e.inArray(o,i.arr2)&&-1===e.inArray(a,i.bookmify_be_data)&&-1===d.indexOf(n)]}}),c>0&&a.datepicker("option","maxDate",new Date((new Date).setMonth((new Date).getMonth()+c)))},checkFourInputsAppointments:function(t){var a=t.find('input[name="category_id"]'),i=t.find('input[name="location_id"]'),o=t.find('input[name="service_id"]'),n=t.find('input[name="employee_id"]'),s=a.val(),r=o.val(),l=n.val(),c=i.val(),p=e(".nano.category_list"),d=e(".nano.service_list"),m=e(".nano.employee_list"),f=e(".nano.location_list"),u=p.find(".nano-content > div"),_=d.find(".nano-content > div"),v=m.find(".nano-content > div"),h=f.find(".nano-content > div");if(u.removeClass(),_.removeClass(),v.removeClass(),h.removeClass(),""===s&&""===r&&""===l&&""===c||(u.addClass("disabled"),_.addClass("disabled"),v.addClass("disabled"),h.addClass("disabled")),""!==s&&""===r&&""===l&&""===c&&u.removeClass(),""!==s){var b=p.find('.nano-content > div[data-category-id="'+s+'"]');b.length&&b.addClass("selected")}if(""!==r&&""===s&&""===l&&""===c&&_.removeClass(),""!==r){var y=d.find('.nano-content > div[data-service-id="'+r+'"]');y.length&&y.addClass("selected")}if(""!==l&&""===s&&""===r&&""===c&&v.removeClass(),""!==l){var C=m.find('.nano-content > div[data-employee-id="'+l+'"]');C.length&&C.addClass("selected")}if(""!==c&&""===s&&""===r&&""===l&&h.removeClass(),""!==c){var k=f.find('.nano-content > div[data-location-id="'+c+'"]');k.length&&k.addClass("selected")}if(""!==c){u.addClass("disabled");var g=","+c+",";u.each(function(){var t=e(this);(","+t.data("location-id")+",").includes(g)&&t.removeClass("disabled")})}if(""!==l){u.addClass("disabled");var x=","+l+",";u.each(function(){var t=e(this);(","+t.data("employee-id")+",").includes(x)&&t.removeClass("disabled")})}if(""!==r){u.addClass("disabled");var D=","+r+",";u.each(function(){var t=e(this);(","+t.data("service-id")+",").includes(D)&&t.removeClass("disabled")})}if(""!==c){var I=","+c+",";_.each(function(){var t=e(this),a=","+t.data("location-id")+",";t.addClass("disabled"),a.includes(I)&&t.removeClass("disabled")})}if(""!==l){var w=","+l+",";_.each(function(){var t=e(this),a=","+t.data("employee-id")+",";t.addClass("disabled"),a.includes(w)&&t.removeClass("disabled").addClass("emp_sel")})}if(""!==s&&""===l){_.addClass("disabled");var A=d.find('.nano-content > div[data-category-id="'+s+'"]');A.length&&A.removeClass("disabled")}if(""!==s&&""!==l&&_.each(function(){var t=e(this);t.hasClass("emp_sel")&&parseInt(t.data("category-id"))==s?t.removeClass("disabled"):t.addClass("disabled")}),""!==s){v.addClass("disabled");var P=","+s+",";v.each(function(){var t=e(this);(","+t.data("category-id")+",").includes(P)&&t.removeClass("disabled")})}if(""!==r){v.addClass("disabled");var S=","+r+",";v.each(function(){var t=e(this);(","+t.data("service-id")+",").includes(S)&&t.removeClass("disabled").addClass("enabled")})}if(""!==c&&""!==r&&v.each(function(){var t=e(this);t.addClass("disabled"),t.attr("data-location-id")===c&&t.hasClass("enabled")&&t.removeClass("disabled")}),""!==c&&""===r){v.addClass("disabled");var F=m.find('.nano-content > div[data-location-id="'+c+'"]');F.length&&F.removeClass("disabled")}if(""!==s){h.addClass("disabled");var E=","+s+",";h.each(function(){var t=e(this);(","+t.data("category-id")+",").includes(E)&&t.removeClass("disabled")})}if(""!==r){h.addClass("disabled");var W=","+r+",";h.each(function(){var t=e(this);(","+t.data("service-id")+",").includes(W)&&t.removeClass("disabled")})}if(""!==l){h.addClass("disabled");var T=","+l+",";h.each(function(){var t=e(this);(","+t.data("employee-id")+",").includes(T)&&t.removeClass("disabled")})}},multiDatesPickerAppointment:function(){var t=e('body > .bookmify_be_popup_form_appointment .day_wrap input[type="text"]'),a=this;t.each(function(){var t=e(this),i=t.closest(".bookmify_be_popup_form_appointment"),o=i.find('input[name="employee_id"]').val(),n=t.siblings('input[type="hidden"]'),s=t.data("selected-day"),r=t.closest(".day_wrap"),l=r.find("span.bot_btn"),c=new Date,p=c.getHours(),d=c.getMinutes(),m=0,f=parseInt(e(".bookmify_be_mintime_tobooking input").val());f<1?(d+=60*f)>60&&p++:f>=1&&f<24?(p+=f)>=24&&(m="+1d"):m="+"+f/24+"d",""!==o&&(t.datepicker({minDate:m,dateFormat:"yy-mm-dd",altField:n,altFormat:"yy-mm-dd",constrainInput:!1}),t.datepicker("setDate",s),t.off().on("click",function(a){a.stopPropagation(),a.preventDefault(),t.closest(".day_wrap").hasClass("input_clicked")?(t.datepicker("hide"),r.removeClass("input_clicked")):(e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),t.datepicker("show"),r.addClass("input_clicked"))}),e(window).on("click",function(){r.removeClass("input_clicked")}),t.datepicker().on("change",function(){t.datepicker("hide"),r.removeClass("input_clicked"),t.parent().removeClass("required_error"),t.parent().find(".error_note").remove()})),t.on("change",function(){""!==n&&(l.addClass("opened"),a.checkValuesServiceEmployeeDateForTimeSlots(i))}),""!==n.val()&&(l.addClass("opened"),a.checkValuesServiceEmployeeDateForTimeSlots(i))})},removeDateFromAppointment:function(){e(".bookmify_be_ad_date_time .day_wrap span.bot_btn").on("click",function(){var t=e(this);t.siblings('input[name="appointment_day"]').datepicker("setDate",null),t.removeClass("opened");var a=t.closest(".bookmify_be_ad_date_time").find(".time_wrap"),i=a.find("input"),o=a.find(".bot_btn");i.val(""),o.removeClass("opened"),e(".nano").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked")})},appointmentTimePopper:function(){var t=this,a=e(".nano.appointment_time"),i=a.find(".nano-content > div"),o=i.length,n=e('body > .bookmify_be_popup_form_appointment input[name="appointment_time"]');n.off().on("click",function(s){s.stopPropagation(),s.preventDefault();var r=e(this),l=r.val(),c=r.closest(".bookmify_be_popup_form_appointment"),p=c.find('input[name="employee_id"]').val(),d=c.find('input[name="service_id"]').val(),m=c.find('input[name="appointment_day_hidden"]').val(),f=c.data("entity-id"),u=-((a.height()-20)/2-11);if(r.hasClass("input_clicked"))r.removeClass("input_clicked"),a.removeClass("focused");else{e(".nano:not(.appointment_time)").removeClass("focused"),e(".bookmify_be_ministatus").removeClass("opened"),e("*:not(.time_wrap) input").removeClass("input_clicked"),e(".day_wrap").removeClass("input_clicked"),r.addClass("input_clicked"),a.css({width:r.outerWidth()+"px"}),new Popper(r,a,{placement:"bottom-start",onUpdate:function(){a.css({width:r.outerWidth()+"px"})}}),a.attr("data-entity-id",f),p&&d&&m?i.removeClass("disabled selected"):a.find(".nano-content").html("").html('<div class="nodata">'+t.cache.nothingFound+"</div>");var _=0;if(l)for(var v=0;v<o;v++){var h=i[v];if(e(h).html()===l){e(h).addClass("selected"),_=1;break}e(h).hasClass("disabled")||(u+=27)}else u=0;0===_&&(u=0),e(".scrollbar-inner").scrollTop(u),a.addClass("focused"),i.on("click",function(){var a=e(this),i=a.html();if(!a.hasClass("disabled")&&!a.hasClass("nodata")){var o=e('body > .bookmify_be_popup_form_appointment input[name="appointment_time"]');o.val(i),o.parent().removeClass("required_error"),o.parent().find(".error_note").remove()}e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),t.checkValueForTimeInputInAppointment(n)})}}),e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),a.on("click",function(e){e.stopPropagation(),e.preventDefault()}),t.checkValueForTimeInputInAppointment(n)},checkValueForTimeInputInAppointment:function(t){var a=t.val(),i=t.siblings(".bot_btn");a&&i.addClass("opened"),i.off().on("click",function(){e(this).removeClass("opened").siblings("input").val("")})},checkValuesServiceEmployeeDateForTimeSlots:function(t,a){var i=this,n=t.data("entity-id"),s=t.find('input[name="service_id"]').val(),r=t.find('input[name="employee_id"]').val(),l=t.find('input[name="appointment_day_hidden"]').val(),c=t.find(".time_wrap");if(s&&r&&l){c.addClass("waiting");var p=new Date,d=parseFloat(e(".bookmify_be_mintime_tobooking input").val()),m=p.getHours(),f=p.getMinutes(),u=(new Date(l).getTime()-p.getTime())/864e5;d<1?(f+=60*d)>=60&&(m++,f-=60):d>=1&&d<24&&(m+=d),n||(n=0);var _={action:"ajaxQueryTimeSlotsAppointment",serID:s,empID:r,dateVal:l,selDayBetween:Math.floor(u)+1,newHours:m,newMinutes:f,appID:n,extraDuration:o.extraDuration};e.ajax({type:"POST",url:i.ajaxurl,cache:!1,data:_,success:function(e){i.timeSlotsAppointmentAjaxProcess(e),c.removeClass("waiting"),"remove"===a&&(c.find(".required_field").val(""),c.find(".bot_btn").removeClass("opened"))},error:function(){}})}},timeSlotsAppointmentAjaxProcess:function(t){var a=e.parseJSON(t).bookmify_be_data,i=e(".nano.appointment_time .nano-content");""===a?i.html("").html('<div class="nodata">'+this.cache.nothingFound+"</div>"):i.html("").html(a),this.appointmentTimePopper()},changeContentOfPopupNumberOfPeopleForAppointment:function(t){var a=t.find('input[name="service_id"]').val(),i=t.find('input[name="employee_id"]').val(),n=e(".nano.number_list .nano-content");if(a&&i){for(var s="",r=1;r<o.serviceCapMax+1;r++)s+="<div>"+r+"</div>";""===s?n.html("").html('<div class="nodata">'+this.cache.nothingFound+"</div>"):n.html("").html(s)}},extraQuantity:function(){var t=this;e("body > .bookmify_be_popup_form_appointment .bookmify_be_quantity").each(function(){var a=e(this),i=a.find('input[type="number"]'),o=a.find(".increase"),n=a.find(".decrease"),s=i.attr("min"),r=i.attr("max");a.hasClass("disabled")||(o.off().on("click",function(){var e,o=parseFloat(i.val());return o>=r?(e=o,!1):(e=o+1,a.find("input").val(e),a.find("input").trigger("change"),t.calcExtraPayment(),t.calculateExtrasDuration("remove"),!1)}),n.off().on("click",function(){var e,o=parseFloat(i.val());return o<=s?(e=o,!1):(e=o-1,a.find("input").val(e),a.find("input").trigger("change"),t.calcExtraPayment(),t.calculateExtrasDuration("remove"),!1)}))})},enableDisableExtraForCustomerInAppointments:function(){var t=this;e("body > .bookmify_be_popup_form_appointment").find(".bookmify_extra_service_item_app").each(function(){var a=e(this),i=a.find(".bookmify_be_quantity"),o=a.find('input[type="checkbox"]'),n=a.find("label");o.on("change",function(){return o.is(":checked")?(i.removeClass("disabled"),a.addClass("active")):(i.addClass("disabled"),a.removeClass("active")),t.extraQuantity(),t.calcExtraPayment(),t.calculateExtrasDuration("remove"),!1}),n.off().on("click",function(){return o.is(":checked")?(o.prop("checked",!1),i.addClass("disabled"),a.removeClass("active")):(o.prop("checked",!0),i.removeClass("disabled"),a.addClass("active")),t.extraQuantity(),t.calcExtraPayment(),t.calculateExtrasDuration("remove"),!1})})},calcExtraPayment:function(){var t,a,i,o,n=this,s=e("body > .bookmify_be_popup_form_appointment"),r=s.find(".bookmify_be_appointment_extras"),l=r.find(".bookmify_be_extras_customer_appointment"),c=r.find(".total_price .price span"),p=r.find('input[name="total_price"]'),d=r.find(".extra_price .price span"),m=r.find('input[name="total_extra"]'),f=r.find(".service_price .price span"),u=r.find('input[name="total_service"]'),_=0,v=0,h=0,b=0,y=r.find(".extra_tax_price .price span"),C=r.find('input[name="total_extra_tax"]'),k=r.find(".service_tax_price .price span"),g=r.find('input[name="total_service_tax"]'),x=s.find(".bookmify_be_appointment_payments");l.each(function(){var s=e(this);if(s.hasClass("item_approved")||s.hasClass("item_pending")){a=parseFloat(s.find(".tax_h_customer").val()),t=0,i=0,o=0;var r=s.data("customer-id"),l=s.find(".bookmify_extra_service_item_app"),c=s.find('input[name="subtotal_value"]'),p=s.find(".sub_price"),d=parseFloat(s.find('input[name="service_price_for_customer"]').val()),m=parseFloat(s.find('input[name="people_count"]').val());l.each(function(){var a=e(this),i=a.find(".req"),o=parseFloat(a.find('input[name="extra_quantity"]').val()),s=parseFloat(a.find('input[name="extra_price"]').val());i.is(":checked")&&(t+=s*o*m),a.find(".price_span").html(n.integerToPriceFormatFunction(s*o*m))}),b+=t*a/100,i+=t*a/100,c.val(t),p.html(n.integerToPriceFormatFunction(t)),v+=d*m,h+=d*m*a/100,o+=d*m*a/100,i=n.floor(i),o=n.floor(o);var f=x.find('[data-customer-id="'+r+'"]');f.length&&(f.find('input[name="extra_total"]').val(t),f.find(".extra_price").html(n.integerToPriceFormatFunction(t)),f.find('input[name="service_total"]').val(d*m),f.find(".service_price").html(n.integerToPriceFormatFunction(d*m)),f.find('input[name="sub_total"]').val(t+d*m+o+i),f.find(".sub_price").html(n.integerToPriceFormatFunction(t+d*m+o+i)),f.find('input[name="extra_tax_total"]').val(i),f.find(".extra_tax_price").html(n.integerToPriceFormatFunction(i)),f.find('input[name="service_tax_total"]').val(o),f.find(".service_tax_price").html(n.integerToPriceFormatFunction(o))),_+=t,t=0,i=0,o=0}}),b=n.floor(b),h=n.floor(h),0===l.length?x.find(".bookmify_be_extras_customer_appointment").each(function(){var t=e(this);a=parseFloat(t.find(".tax_h_customer").val());var i=parseFloat(t.find('input[name="service_price_for_customer"]').val()),o=parseFloat(t.find('input[name="people_count"]').val()),s=i*o,r=i*o*a/100;r=n.floor(r),t.find('input[name="extra_total"]').val(0),t.find(".extra_price").html(n.integerToPriceFormatFunction(0)),t.find('input[name="service_total"]').val(s),t.find(".service_price").html(n.integerToPriceFormatFunction(s)),t.find('input[name="sub_total"]').val(s+r),t.find(".sub_price").html(n.integerToPriceFormatFunction(s+r)),t.find('input[name="extra_tax_total"]').val(0),t.find(".extra_tax_price").html(n.integerToPriceFormatFunction(0)),t.find('input[name="service_tax_total"]').val(r),t.find(".service_tax_price").html(n.integerToPriceFormatFunction(r))}):(f.html(n.integerToPriceFormatFunction(v)),u.val(v),d.html(n.integerToPriceFormatFunction(_)),m.val(_),y.html(n.integerToPriceFormatFunction(b)),C.val(b),k.html(n.integerToPriceFormatFunction(h)),g.val(h),_+=v,c.html(n.integerToPriceFormatFunction(_+b+h)),p.val(_+b+h)),_=0,t=0},floor:function(e){return Math.floor(100*parseFloat(e))/100},integerToPriceFormatFunction:function(t){var a,i,o,n,s=e(".bookmify_be_price_hidden"),r=s.find(".currency_format").val(),l=s.find(".currency_position").val(),c=s.find(".price_format").val(),p=parseFloat(s.find(".price_decimal").val());switch(c){default:case"cd":o=".",n=",";break;case"dc":o=",",n=".";break;case"sd":o=".",n=" ";break;case"sc":o=",",n=" "}isNaN(p=Math.abs(p))&&(p=2),(i=(a=parseInt(t=(+t||0).toFixed(p))+"").length)>3?i%=3:i=0;var d=(i?a.substr(0,i)+n:"")+a.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+n)+(p?o+Math.abs(t-a).toFixed(p).replace(/-/,0).slice(2):"");switch(l){default:case"left":d=r+d;break;case"lspace":d=r+" "+d;break;case"right":d+=r;break;case"rspace":d=d+" "+r}return d},reBuildExtrasAppointment:function(t,a,i,o,n){var s=this,r=o.find(".bookmify_be_appointment_extras");if(""===a||""===i)r.html(s.cache.CES);else{var l={action:"ajaxQueryGetExtrasOfServiceForAppointment",customerIDs:t,serviceID:a,employeeID:i,customerData:n};e.ajax({type:"POST",url:s.ajaxurl,cache:!1,data:l,success:function(e){s.reBuildExtrasAppointmentAjaxProcess(e,r,o),s.imgToSvg(),s.enableDisableExtraForCustomerInAppointments(),s.extraQuantity()},error:function(){}})}},reBuildExtrasAppointmentAjaxProcess:function(t,a,n){var s=e.parseJSON(t),r=s.bookmify_be_data;a.html(r),i.div1=s.buffy2,i.div2=s.buffy3,o.serviceDuration=parseInt(s.duration),o.serviceCapMax=parseInt(s.max),o.serviceCapMin=parseInt(s.min),""!==o.serviceCapMax&&""!==o.serviceCapMin&&e(".bookmify_be_popup_form_wrap .ad_customers_info").removeClass("danger").html("<label>"+this.minCapacity+'</label><span class="min">'+o.serviceCapMin+"</span><label>"+this.maxCapacity+'</label><span class="max">'+o.serviceCapMax+"</span>");e(".bookmify_be_popup_form_wrap .ad_customer_list_with_info .item").each(function(){var t=e(this),a=parseInt(t.find("input").val()),i=e(this).data("customer-id");a>o.serviceCapMax&&(t.find("input").val(o.serviceCapMax),e('.bookmify_be_extras_customer_appointment[data-customer-id="'+i+'"] input[name="people_count"]').val(o.serviceCapMax),0)}),this.calcExtraPayment(),this.changeContentOfPopupNumberOfPeopleForAppointment(n)},reBuildPaymentsAppointment:function(t,a,i,o,n){var s=this,r=o.find(".bookmify_be_appointment_payments");if(""===a||""===i)r.html(s.cache.CES);else{var l={action:"ajaxQueryGetPaymentsCustomersForAppointment",customerIDs:t,serviceID:a,employeeID:i,customerData:n};e.ajax({type:"POST",url:s.ajaxurl,cache:!1,data:l,success:function(e){s.reBuildPaymentsAppointmentAjaxProcess(e,r)},error:function(){}})}},reBuildPaymentsAppointmentAjaxProcess:function(t,a){var o=e.parseJSON(t),n=o.bookmify_be_data;a.html(n),i.div3=o.buffy4},removeExtraAndPayment:function(t){var a=e("body > .bookmify_be_popup_form_appointment");"destroy"===t?(a.find(".bookmify_be_appointment_extras").html(this.cache.CES),a.find(".bookmify_be_customer_payments_list").html(this.cache.CES)):(a.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+t+'"]').remove(),a.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+t+'"]').remove(),0===a.find(".bookmify_be_extras_customer_appointment").length&&(a.find(".bookmify_be_appointment_extras").html(this.cache.CES),a.find(".bookmify_be_ad_customers .ad_customers_list .customer span.bot_btn").removeClass("opened")));this.calcExtraPayment(),this.enableDisableExtraForCustomerInAppointments()},addExtraAndPayment:function(t,a,o,n,s,r){if(""!==s&&""!==r){var l=i.div1,c=i.div2,p=i.div3,d=e("body > .bookmify_be_popup_form_appointment"),m=d.find(".bookmify_be_appointment_extras"),f=d.find(".bookmify_be_appointment_payments");if(""!==l)if(m.find(".bookmify_be_extras_customer_appointment").length)if(!1===n)m.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+t+'"]').remove();else{m.find(".bookmify_be_customer_extras_list").append(l);var u=m.find(".bookmify_be_customer_extras_list .bookmify_be_extras_customer_appointment:last");u.attr("data-customer-id",t),u.find(".name_holder .name").html(a),u.find(".name_holder .email").html(o)}else if(!1===n)m.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+t+'"]').remove();else{m.html('<div class="bookmify_be_customer_extras_list">'+l+"</div>"+c);var _=m.find(".bookmify_be_customer_extras_list .bookmify_be_extras_customer_appointment:last");_.attr("data-customer-id",t),_.find(".name_holder .name").html(a),_.find(".name_holder .email").html(o)}else m.html(this.cache.noExtras);if(f.find(".bookmify_be_extras_customer_appointment").length)if(!1===n)f.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+t+'"]').remove();else{f.find(".bookmify_be_customer_payments_list").append(p);var v=f.find(".bookmify_be_customer_payments_list .bookmify_be_extras_customer_appointment:last");v.attr("data-customer-id",t),v.find(".name_holder .name").html(a),v.find(".name_holder .email").html(o)}else if(!1===n)f.find('.bookmify_be_extras_customer_appointment[data-customer-id="'+t+'"]').remove();else{f.html('<div class="bookmify_be_customer_payments_list">'+p+"</div>");var h=f.find(".bookmify_be_customer_payments_list .bookmify_be_extras_customer_appointment:last");h.attr("data-customer-id",t),h.find(".name_holder .name").html(a),h.find(".name_holder .email").html(o)}if(0===d.find(".bookmify_be_extras_customer_appointment").length)return this.removeExtraAndPayment("destroy"),!1;this.calcExtraPayment(),this.enableDisableExtraForCustomerInAppointments()}},cancelItem:function(){var t=this;e(".bookmify_be_popup_form_button a.cancel").off().on("click",function(){return t.closePopupForm(),!1})},saveAppointment:function(){var t=e(".bookmify_be_popup_form_appointment .bookmify_be_popup_form_button a.save"),i=this;t.off().on("click",function(){var t=e(this),n=t.closest(".bookmify_be_popup_form_appointment"),s="insert",r=n.data("entity-id"),l=0,c=0,p=n.find(".bookmify_be_appointmentstabs_wrap > .bookmify_be_link_tabs"),d=n.find(".bookmify_be_appointmentstabs_wrap > .bookmify_be_content_tabs");if(n.find(".required_field").each(function(){var t=e(this);""===t.val()&&(t.parent().find(".error_note").remove(),t.parent().addClass("required_error").append(i.errorField),l++)}),0!==l)return 0!==p.find("li.active").index()&&(p.find("li.active").removeClass("active"),d.children(".bookmify_be_tab_pane.active").removeClass("active"),p.find("li:first").addClass("active"),d.children(".bookmify_be_tab_pane:first").addClass("active"),c=50),setTimeout(function(){i.scrollToTop(500)},c),!1;var m=0,f=0,u=0,_=0,v="pending";if(n.find(".ad_customer_list_with_info .item").each(function(){var t=e(this),a=t.find(".bookmify_be_ministatus .label label").attr("class"),i=parseInt(t.find("input").val());"approved"===a?(f+=i,0):"pending"===a?0:"canceled"===a?u++:_++,m++}),0!==f&&f>o.serviceCapMax)return n.find(".ad_customers_info").addClass("danger"),0!==p.find("li.active").index()&&(p.find("li.active").removeClass("active"),d.children(".bookmify_be_tab_pane.active").removeClass("active"),p.find("li:first").addClass("active"),d.children(".bookmify_be_tab_pane:first").addClass("active"),c=50),setTimeout(function(){i.scrollToTop(500)},c),!1;n.find(".ad_customers_info").removeClass("danger"),v="approved",0!==f&&f<o.serviceCapMin&&(v="pending"),0===f&&(v="pending"),m===_&&(v="rejected"),m===u&&(v="canceled"),r&&(s="update"),t.addClass("await");var h=n.find(".bookmify_be_appointment_details"),b={};b.ID=parseInt(r),b.serID=parseInt(h.find("input[name='service_id']").val()),b.empID=parseInt(h.find("input[name='employee_id']").val()),b.dateApp=h.find("input[name='appointment_day_hidden']").val(),b.timeApp=h.find("input[name='appointment_time']").val(),b.checked=!0===h.find(".notify .req").prop("checked")?"public":"private",b.info=h.find("textarea").val();var y=n.find(".bookmify_be_appointment_extras .bookmify_be_extras_customer_appointment"),C=n.find(".bookmify_be_appointment_payments .bookmify_be_extras_customer_appointment"),k=[],g="no";y.length?(y.each(function(){var t={},a=e(this);t.ID=parseInt(a.data("customer-id")),t.serPrice=parseFloat(a.find("input[name='service_price_for_customer']").val()),t.peopleCount=parseInt(a.find("input[name='people_count']").val()),t.status=h.find('.ad_customer_list_with_info .item[data-customer-id="'+t.ID+'"] .bookmify_be_ministatus .label label').attr("class"),t.extras=[],a.find(".bookmify_extra_service_item_app.active").each(function(){var a=e(this),i={},o=a.data("id"),n=parseInt(a.find("input[name='extra_quantity']").val()),s=parseFloat(a.find("input[name='extra_price']").val());i.ID=o,i.quantity=n,i.price=s,t.extras.push(i)}),k.push(t)}),g="yes"):C.each(function(){var t={},a=e(this);t.ID=parseInt(a.data("customer-id")),t.serPrice=parseFloat(a.find("input[name='service_price_for_customer']").val()),t.peopleCount=parseInt(a.find("input[name='people_count']").val()),t.status=h.find('.ad_customer_list_with_info .item[data-customer-id="'+t.ID+'"] .bookmify_be_ministatus .label label').attr("class"),k.push(t)});var x={action:"ajaxQueryInsertOrUpdateAppointment",details:JSON.stringify(b),allCustomers:JSON.stringify(k),insertOrUpdate:s,haveExtras:g,duration:parseInt(o.serviceDuration+o.extraDuration),do:1,status:v,bookmify_page:a.page,bookmify_search:a.search,bookmify_services:a.servicesIDs,bookmify_customer:a.customerID,bookmify_employee:a.employeeID,bookmify_status:a.status,bookmify_daterange:a.dateRange};return e.ajax({type:"POST",url:i.ajaxurl,cache:!1,data:x,success:function(e){t.removeClass("await"),i.getUpdatedAppointmentList(e,s)},error:function(){}}),!1})},getUpdatedAppointmentList:function(t,a){var i=this,o=e.parseJSON(t),n=e(".bookmify_be_appointments_list"),s=e(".bookmify_be_page_title h3 span.count");i.closePopupForm(),"update"===a?setTimeout(function(){e.iaoAlert({msg:i.alertSuccessIcon+i.savedText,type:"success",alertTime:i.iaoAlertTime,position:i.iaoAlertPosition})},301):setTimeout(function(){e.iaoAlert({msg:i.alertSuccessIcon+i.addedText,type:"success",alertTime:i.iaoAlertTime,position:i.iaoAlertPosition})},301),n.html(o.bookmify_be_data),s.html(o.number);var r=n.find(".bookmify_be_list_item");setTimeout(function(){r.each(function(t,a){setTimeout(function(){e(a).addClass("fadeInTop done")},100*t)})},150),i.init()},scrollToTop:function(t){e(".bookmify_be_popup_form_wrap").animate({scrollTop:0},t)},callAlertBoxCapacity:function(){e(".bookmify_be_popup_form_wrap .ad_customers_info").addClass("danger").html(this.clearCapacity)},insertAppointment:function(){var t=this;e(".bookmify_be_add_new_appointment a").off().on("click",function(){var a=n.cloneForm.clone();e("body").addClass("disable_scroll").append(a),e("body > .bookmify_be_popup_form_wrap").addClass("bookmify_be_popup_form_appointment");var i=e("body > .bookmify_be_popup_form_appointment");return t.imgToSvg(),t.universalTab(),t.checkFourInputsAppointments(i),t.popperCustomersForAppointments(),t.miniStatusForAppointments(i),t.categoryPopperForAppointment(),t.servicePopperForAppointment(),t.employeePopperForAppointment(),t.locationPopperForAppointment(),t.numberOfPeopleForAppointments(),t.appointmentTimePopper(),t.extraQuantity(),t.enableDisableExtraForCustomerInAppointments(),t.doFilter(),t.changeContentOfPopupNumberOfPeopleForAppointment(i),t.multiDatesPickerAppointment(),t.removeDateFromAppointment(),t.removeCustomerItemForAppointment(),t.cancelItem(),t.saveAppointment(),setTimeout(function(){e("body > .bookmify_be_popup_form_wrap").addClass("enable"),t.closersPopup()},10),!1})},deleteAppointment:function(){var t=e(".bookmify_be_appointments_list .bookmify_be_delete"),a=this;t.off().on("click",function(){e(".bookmify_be_filter_list").removeClass("opened");var t=e(this),i=t.data("entity-id"),o=t.parents(".bookmify_be_list_item");return!o.hasClass("bookmify_be_closed_item")&&!t.parent().hasClass("bookmify_be_closed_btn")&&(o.hasClass("bookmify_be_open_item")&&t.parent().hasClass("bookmify_be_open_btn")?(t.addClass("clicked"),a.confirmDeleteAppointment(o,i,t),!1):void 0)})},confirmDeleteAppointment:function(t,i,o){var n=e("#bookmify_be_confirm"),s=n.find("a.yes"),r=n.find("a.no"),l=this;n.addClass("opened"),s.off().on("click",function(s){return s.preventDefault(),o.removeClass("clicked"),o.addClass("await"),o.addClass("loading"),t.addClass("loading"),e.ajax({type:"POST",url:l.ajaxurl,cache:!1,data:{action:"ajaxQueryDeleteAppointment",ID:i,bookmify_page:a.page,bookmify_search:a.search,bookmify_services:a.servicesIDs,bookmify_customer:a.customerID,bookmify_employee:a.employeeID,bookmify_status:a.status,bookmify_daterange:a.dateRange},success:function(e){l.getRequestedAppointmentListAfterDeleting(e,o,t)},error:function(){}}),n.removeClass("opened"),!1}),r.on("click",function(){return n.removeClass("opened"),o.removeClass("clicked"),!1}),e(document).keydown(function(e){if(27===e.keyCode)return n.removeClass("opened"),o.removeClass("clicked"),!1})},getRequestedAppointmentListAfterDeleting:function(t,a,i){var o=this,n=e.parseJSON(t);if("warning"===n.buffy)a.removeClass("await loading"),i.parent().removeClass("opened"),i.removeClass("loading"),e.iaoAlert({msg:o.alertWarningIcon+o.errorDelete,type:"success",alertTime:o.iaoAlertTime,position:o.iaoAlertPosition});else{e(".bookmify_be_page_title h3 span.count").html(n.number);var s=e(".bookmify_be_appointments_list");if(a.removeClass("await"),setTimeout(function(){e.iaoAlert({msg:o.alertSuccessIcon+o.deletedText,type:"success",alertTime:o.iaoAlertTime,position:o.iaoAlertPosition})},300),""===n.buffy){s.html(n.list);var r=s.find(".bookmify_be_list_item");setTimeout(function(){r.each(function(t,a){setTimeout(function(){e(a).addClass("fadeInTop done")},100*t)})},150)}else s.html(n.buffy);o.init()}},openDetailsAppointment:function(){var t=this;e(".bookmify_appointment_heading a.bookmify_be_more").off().on("click",function(a){a.preventDefault();var i=e(this),o=i.data("entity-id"),n=i.parents(".bookmify_be_list_item"),s={action:"ajaxQueryDetailsAppointment",bookmify_data:o};return i.hasClass("await")||(i.addClass("await"),n.addClass("loading"),e.ajax({type:"POST",url:t.ajaxurl,cache:!1,data:s,success:function(e){i.removeClass("await"),n.removeClass("loading"),t.getRequestedAppointmentDetailsPopup(e)},error:function(e,t,a){console.log(a),console.log(t),console.log(e)}})),!1})},getRequestedAppointmentDetailsPopup:function(t){var a=e.parseJSON(t).bookmify_be_data;e("body").addClass("disable_scroll").append(a),e("body > .bookmify_be_popup_form_wrap").addClass("bookmify_be_popup_form_appointment"),e("body > .bookmify_be_popup_form_wrap").addClass("enable"),this.closersPopup(),this.imgToSvg(),this.universalTab()}};e(document).ready(function(){s.init()})}(jQuery);