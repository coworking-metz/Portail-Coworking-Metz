!function(e){"use strict";e.fn.frenifyMoveCursorToEnd=function(){this.focus();var e=this.val();return this.val("").val(e),this};var i=bookmifyConfig,a={page:1,id:"all"},t={iaoAlertTime:"5000",iaoAlertPosition:"bottom-right",alertSuccessIcon:'<span class="icon_holder success"><i class="xcon-ok"></i></span>',alertWarningIcon:'<span class="icon_holder warning"><i class="xcon-attention-alt"></i></span>',currentForm:"",catUpdated:'<span class="text">'+i.updatedCategory+"</span>",catAdded:'<span class="text">'+i.addedCategory+"</span>",catOrdered:'<span class="text">'+i.orderedCategory+"</span>",catUpdateWarning:'<span class="text">'+i.updateWarningCategory+"</span>",catDeleted:'<span class="text">'+i.deletedCategory+"</span>",serUpdated:'<span class="text">'+i.updatedService+"</span>",serDeleted:'<span class="text">'+i.deletedService+"</span>",serAdded:'<span class="text">'+i.addedService+"</span>",extrasOrdered:'<span class="text">'+i.orderedExtra+"</span>",errorField:'<span class="error_note">'+i.errorField+"</span>",cantDeleteCategory:i.cantDeleteCategory,cantDeleteService:i.cantDeleteService,assetsURI:i.assetsURL,ajaxurl:i.ajaxUrl,init:function(){this.allNanoAppendToBody(),this.imgToSvg(),this.addCategory(),this.reorderCat(),this.updateCat(),this.deleteCat(),this.insertService(),this.openerService(),this.deleteService(),this.duplicateService(),this.doFilter(),e.protip()},allNanoAppendToBody:function(){var i=e(".bookmify_be_all_nano.service"),a=i.html();e("body").append(a),i.remove()},reBuildCategoryNano:function(i){e(".nano.service_categories").remove(),e("body").append(i),this.init()},imgToSvg:function(){e("img.bookmify_be_svg").each(function(){var i=e(this),a=i.attr("class"),t=i.attr("src");e.get(t,function(t){var o=e(t).find("svg");void 0!==a&&(o=o.attr("class",a+" replaced-svg")),o=o.removeAttr("xmlns:a"),i.replaceWith(o)},"xml")})},addCategory:function(){var i=this,a=e(".bookmify_be_service_page").find(".cat_list_wrap"),t=a.find("a.add_new"),o=e("form#add_new_category").serialize();t.off().on("click",function(){t.addClass("await");var n={action:"ajaxQueryInsertCategory",bookmify_data:o};return e.ajax({type:"POST",url:i.ajaxurl,cache:!0,data:n,success:function(e){i.addCategoryAjaxProcess(e,a),t.removeClass("await")}}),!1})},addCategoryAjaxProcess:function(i,a){var t=e.parseJSON(i);a.find(".cat_list ul").append(t.html),this.reBuildCategoryNano(t.updatedNano),e.iaoAlert({msg:this.alertSuccessIcon+this.catAdded,type:"success",alertTime:this.iaoAlertTime,position:this.iaoAlertPosition}),a.find(".cat_list ul li:last .cat_name input[type=text]").frenifyMoveCursorToEnd(),this.imgToSvg(),this.updateCat(),this.deleteCat(),this.reorderCat()},reorderCat:function(){var i=e(".cat_list ul"),a=this;i.sortable({opacity:.7,cursor:"move",axis:"y",handle:".bookmify_drag_handle",update:function(){var t=[];i.children("li").each(function(){var i=e(this).data("category-id");t.push(i)}),e.ajax({type:"POST",url:a.ajaxurl,cache:!1,data:{action:"ajaxQueryReorderCategory",bookmify_cat_ids:t},success:function(i){var t=e.parseJSON(i);a.reBuildCategoryNano(t.updatedNano),a.init(),e.iaoAlert({msg:a.alertSuccessIcon+a.catOrdered,type:"success",alertTime:a.iaoAlertTime,position:a.iaoAlertPosition,fadeTime:"1000"})}})}})},updateCat:function(){var i=e(".cat_list ul li"),a=e(".cat_list ul .bookmify_be_edit"),t=this;a.off().on("click",function(a){a.preventDefault();var o=e(this),n=o.closest(".top_part").parent(),s=n.find("form"),r=n.find(".cat_name").find("span"),c=s.find('input[name="cat_old_name"]').val(),l=s.find("input[type=text]").val();if(n.hasClass("opened"))if(""===l)e.iaoAlert({msg:t.alertWarningIcon+t.catUpdateWarning,type:"success",alertTime:t.iaoAlertTime,position:t.iaoAlertPosition});else{if(c===l)return n.removeClass("opened"),!1;o.addClass("await");var d={action:"ajaxQueryUpdateCategory",bookmify_data:s.serialize()};e.ajax({type:"POST",url:t.ajaxurl,cache:!0,data:d,success:function(i){o.removeClass("await"),n.removeClass("opened"),r.html(l);var a=e.parseJSON(i);t.reBuildCategoryNano(a.updatedNano),s.find('input[name="cat_old_name"]').val(l),e.iaoAlert({msg:t.alertSuccessIcon+t.catUpdated,type:"success",alertTime:t.iaoAlertTime,position:t.iaoAlertPosition})}})}else i.removeClass("opened"),n.addClass("opened");return s.find(".cat_name input[type=text]").frenifyMoveCursorToEnd(),!1})},deleteCat:function(){var i=e(".cat_list ul .bookmify_be_delete"),a=this;i.off().on("click",function(){var i=e(this),t=i.closest(".top_part").parent("li"),o=i.data("entity-id");return i.addClass("clicked"),a.deleteConfirmCat(t,o,i),!1})},deleteConfirmCat:function(i,a,t){var o=this,n=e("#bookmify_be_confirm");n.addClass("opened category_confirm");var s=e("#bookmify_be_confirm.category_confirm").find("a.yes"),r=e("#bookmify_be_confirm.category_confirm").find("a.no");s.off().on("click",function(s){s.preventDefault(),t.removeClass("clicked"),n.removeClass("opened category_confirm"),i.addClass("await"),t.addClass("await");var r={action:"ajaxQueryDeleteCategory",bookmify_cat_id:a};return e.ajax({type:"POST",url:o.ajaxurl,cache:!0,data:r,success:function(a){var n=e.parseJSON(a);0===parseInt(n.count)?(i.slideUp(500),setTimeout(function(){i.remove()},501),o.reBuildCategoryNano(n.updatedNano),e.iaoAlert({msg:o.alertSuccessIcon+o.catDeleted,type:"success",alertTime:o.iaoAlertTime,position:o.iaoAlertPosition})):(t.removeClass("await"),i.removeClass("await"),e.iaoAlert({msg:o.alertWarningIcon+'<span class="error_note">'+o.cantDeleteCategory+" "+n.count+"</span>",type:"success",alertTime:o.iaoAlertTime,position:o.iaoAlertPosition}))}}),!1}),r.on("click",function(){return n.removeClass(),t.removeClass("clicked"),!1})},reorderGalleryService:function(){var i=this;e("ul.service_gallery_list").each(function(){var a=e(this),t=!1,o=a.find("li").length,n=a.parent().find('input[name="gallery_ids"]');a.sortable({opacity:.7,cursor:"move",axis:!1,distance:10,handle:".li_item",change:function(i,a){a.placeholder.index()===o?e(a.placeholder).css("display","none"):e(a.placeholder).css("display","")},beforeStop:function(e,i){t=i.placeholder.index()===o},stop:function(){t&&e(this).sortable("cancel")},update:function(){var t=[];a.children("li").each(function(){var i=e(this).data("img-id");e.isNumeric(i)&&t.push(i)}),n.val(t),i.deleteGalleryService()}})})},addGalleryService:function(){var i=this;e("ul.service_gallery_list li.add_images").off().on("click",function(a){a.preventDefault(),a.stopPropagation();var t=e(this).parent(),o=t.closest(".bookmify_service_item_content").parent().data("service-id"),n="",s=t.parent().find('input[name="gallery_ids"]'),r=s.val(),c="",l=wp.media({library:{type:"image"},multiple:!0});return l.on("select",function(){var a=l.state().get("selection").toJSON();if(a.length){for(var d=0;d<a.length;d++)n=void 0!==a[d].sizes.large?a[d].sizes.large.url:a[d].url,t.find("li:last").before('<li class="drag_handle" data-img-id="'+a[d].id+'"><div class="item li_item"><div class="thumb_wrap" style="background-image:url('+n+')"><div class="thumb_remove"><a href="#" class="bookmify_be_delete" data-entity-id="'+o+'"><img class="bookmify_be_svg" src="'+i.assetsURI+'img/delete.svg" alt="" /></a></div></div></div></li>'),c+=","+a[d].id;e(this).hide(),e.isNumeric(r.substr(r.length-1))?s.val(r+c):(c=c.substring(1),s.val(r+c)),i.imgToSvg(),i.reorderGalleryService(),i.deleteGalleryService()}}),l.open(),!1})},deleteGalleryService:function(){var i=this;e("ul.service_gallery_list li .thumb_remove a").on("click",function(a){a.preventDefault(),a.stopPropagation();for(var t=e(this).closest("li.drag_handle"),o=t.parent(),n=o.find("li"),s=n.length,r="",c=o.parent().find('input[name="gallery_ids"]'),l=0;l<s;l++){var d=n[l],p=e(d).data("img-id");l!==t.index()&&e.isNumeric(p)&&(r+=p+",")}return r=r.slice(0,-1),c.val(r),t.animate({width:"toggle"},300).remove(),i.reorderGalleryService(),i.addGalleryService(),!1})},capacityMaxExtras:function(){e("ul.extra_service_list .bookmify_be_quantity").each(function(){var i=e(this),a=i.find('input[type="number"]'),t=i.find(".increase"),o=i.find(".decrease"),n=a.attr("min"),s=a.attr("max");t.off().on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");var t,o=parseFloat(a.val());if(o>=s)return t=o,!1;t=o+1,i.find("input").val(t),i.find("input").trigger("change")}),o.off().on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");var t,o=parseFloat(a.val());if(o<=n)return t=o,!1;t=o-1,i.find("input").val(t),i.find("input").trigger("change")})})},addGalleryExtras:function(){var i=this;e(".extra_thumb_edit").on("click",function(a){a.preventDefault(),a.stopPropagation();var t=e(this).closest("li.extra_item"),o=t.find(".extra_heading .img_holder"),n=t.find('input[name="extra_img_id"]'),s=t.find(".extra_thumb_wrap"),r=t.find(".extra_thumb_remove"),c="",l="",d=wp.media({library:{type:"image"},multiple:!1});return d.on("select",function(){var a=d.state().get("selection").toJSON();a.length&&(c=void 0!==a[0].sizes.thumbnail?a[0].sizes.thumbnail.url:a[0].url,l=void 0!==a[0].sizes.large?a[0].sizes.large.url:a[0].url,n.val(a[0].id),s.addClass("has_image").css({"background-image":"url("+l+")"}),o.css({"background-image":"url("+c+")"}),e(this).hide(),r.addClass("has_image"),i.deletGalleryExtras())}),d.open(),!1}),i.deletGalleryExtras()},deletGalleryExtras:function(){e(".extra_thumb_remove a").on("click",function(i){i.preventDefault(),i.stopPropagation();var a=e(this).closest("li.extra_item"),t=a.find(".extra_heading .img_holder"),o=a.find('input[name="extra_img_id"]'),n=a.find(".extra_thumb_wrap");return o.val(""),n.removeClass("has_image").css({"background-image":"none"}),t.css({"background-image":"none"}),e(this).parent().removeClass("has_image"),!1})},popperDurationExtras:function(){var i=this;e('ul.extra_service_list .duration input[type="text"]').each(function(){var a=e(this),t=e(".nano.buffer_time.extra_duration"),o=a.parent(),n=o.find(".bot_btn"),s=o.find('input[type="hidden"]');e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),a.off().stop(!0,!0).on("click",function(a){a.stopPropagation(),a.preventDefault();var s=e(this);if(s.hasClass("input_clicked"))e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");else{e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),s.addClass("input_clicked"),t.addClass("focused");new Popper(s,t,{placement:"bottom-start",onUpdate:function(){t.css({width:s.outerWidth()+"px"})}});t.css({width:s.outerWidth()+"px"})}t.find(".nano-content > div").off().stop(!0,!0).on("click",function(a){a.stopPropagation(),a.preventDefault();var t=e(this).html(),r=e(this).data("sec");s.val(t),s.closest(".bookmify_be_list_item").find(".extra_duration,.e_duration").html(t),o.find('input[type="hidden"]').val(r),i.checkDurationValueExtras(s,n),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")})}),t.css({width:a.outerWidth()+"px"}),n.on("click",function(){a.val(""),s.val(0),n.removeClass("opened"),a.closest(".bookmify_be_list_item").find(".extra_duration,.e_duration").html(""),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),i.checkDurationValueExtras(a,n)})},checkDurationValueExtras:function(e,i){" "===e.val()||""===e.val()?i.removeClass("opened"):i.addClass("opened")},extrasOpener:function(){var i=e("ul.extra_service_list > li"),a=i.find(".extra_content"),t=i.find(".extra_heading .bookmify_be_edit"),o=this;t.off().on("click",function(t){t.preventDefault();var n=e(this),s=n.closest(".extra_item"),r=s.find(".extra_content"),c=n.closest("ul"),l=0;return e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),o.simultaneouslyTyping(),c.hasClass("opened")&&c.children("li.opened").find(".required_field").each(function(){var i=e(this);""===i.val()&&(i.parent().find(".error_note").remove(),i.parent().addClass("required_error").append(o.errorField),l++)}),0===l&&(s.hasClass("opened")?(r.slideUp(),s.removeClass("opened").parent().removeClass("opened").parent().removeClass("opened")):(a.slideUp(),r.slideDown(),i.removeClass("opened"),s.addClass("opened").parent().addClass("opened").parent().addClass("opened")),!1)})},insertExtras:function(){var i=e(".add_extra_button a"),a=this;i.off().on("click",function(){var i=e(this).closest(".bookmify_be_extra_service_edit"),t=e(".bookmify_be_content .bookmify_be_clone_extra").clone(),o=i.find("ul.extra_service_list"),n=0,s=0;return e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),o.hasClass("opened")&&(o.children("li.opened").find(".required_field").each(function(){var i=e(this);""===i.val()&&(i.parent().find(".error_note").remove(),i.parent().addClass("required_error").append(a.errorField),s++)}),0===s&&(o.removeClass("opened").children("li").removeClass("opened").find(".extra_content").slideUp(300),n=300)),0!==s?(a.scrollToTop(300),!1):(setTimeout(function(){o.append(t),o.addClass("opened").children("li:last").addClass("opened").find(".extra_content").slideDown(),a.imgToSvg(),a.capacityMaxExtras(),a.popperDurationExtras(),a.addGalleryExtras(),a.extrasOpener(),a.deleteExtras(),a.simultaneouslyTyping(),a.reorderExtras(),a.saveService(),a.insertExtras()},n),!1)})},deleteExtras:function(){var i=this;e("ul.extra_service_list .extra_heading .bookmify_be_delete").off().on("click",function(){var a=e(this),t=a.data("entity-id"),o=a.closest(".extra_item");if(e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),t)a.addClass("clicked"),i.deleteConfirmExtras(o,t,a);else{var n=a.closest("li");n.hasClass("opened")?(n.slideUp(500),setTimeout(function(){n.parent().removeClass("opened"),n.remove()},501)):(n.slideUp(300),setTimeout(function(){n.remove()},301))}return!1})},deleteConfirmExtras:function(i,a,t){var o=this,n=e("#bookmify_be_confirm");n.addClass("opened extra_confirm");var s=e("#bookmify_be_confirm.extra_confirm").find("a.yes"),r=e("#bookmify_be_confirm.extra_confirm").find("a.no");s.off().on("click",function(s){t.removeClass("clicked"),s.preventDefault(),n.removeClass("opened extra_confirm");var r={action:"ajaxQueryDeleteExtraService",bookmify_extra_id:a};e.ajax({type:"POST",url:o.ajaxurl,cache:!0,data:r,success:function(){return i.slideUp(500),setTimeout(function(){i.remove()},600),i.parent().removeClass("opened"),o.extrasOpener(),setTimeout(function(){e.iaoAlert({msg:o.alertSuccessIcon+o.serDeleted,type:"success",alertTime:o.iaoAlertTime,position:o.iaoAlertPosition})},800),!1}})}),r.on("click",function(){return t.removeClass("clicked"),n.removeClass(),!1})},reorderExtras:function(){var i=this;e("ul.extra_service_list").each(function(){e(this).sortable({opacity:.7,cursor:"move",axis:"y",handle:".bookmify_drag_handle",update:function(){i.saveService()}})})},insertService:function(){var i=this;e(".bookmify_be_add_new_service a").off().on("click",function(){var a=e(".bookmify_be_content .bookmify_be_popup_form_wrap").clone();return e("body").addClass("disable_scroll").append(a),e("body > .bookmify_be_popup_form_wrap").addClass("bookmify_be_popup_form_service"),i.imgToSvg(),i.universalTab(),i.reorderGalleryService(),i.addGalleryService(),i.deleteGalleryService(),i.extrasOpener(),i.insertExtras(),i.deleteExtras(),i.reorderExtras(),i.capacityMaxExtras(),i.addGalleryExtras(),i.popperDurationExtras(),i.colorPicker(),i.uploadDeleteMedia(),i.popperCatForService(),i.popperEmployeeForService(),i.popperTaxForService(),i.popperDurationService(),i.saveService(),i.cancelItem(),i.capacityMinMaxService(),e("body > .bookmify_be_popup_form_wrap").addClass("enable"),i.closersPopup(),!1})},openerService:function(){var i=this;e(".bookmify_be_service_item .bookmify_be_edit").off().on("click",function(a){a.preventDefault();var t=e(this),o=t.closest(".bookmify_be_service_item"),n={action:"ajaxQueryEditService",bookmify_data:o.data("service-id")};return t.hasClass("loading")||(t.addClass("loading"),o.addClass("loading"),e.ajax({type:"POST",url:i.ajaxurl,cache:!1,data:n,success:function(e){t.removeClass("loading"),o.removeClass("loading"),i.getRequestedServicePopup(e)},error:function(){}})),!1})},getRequestedServicePopup:function(i){var a=e.parseJSON(i).bookmify_be_data;e("body").addClass("disable_scroll").append(a),e("body > .bookmify_be_popup_form_wrap").addClass("bookmify_be_popup_form_service"),this.imgToSvg(),this.universalTab(),this.reorderGalleryService(),this.addGalleryService(),this.deleteGalleryService(),this.extrasOpener(),this.insertExtras(),this.deleteExtras(),this.reorderExtras(),this.capacityMaxExtras(),this.addGalleryExtras(),this.popperDurationExtras(),this.colorPicker(),this.uploadDeleteMedia(),this.popperCatForService(),this.popperEmployeeForService(),this.popperTaxForService(),this.popperDurationService(),this.saveService(),this.cancelItem(),this.capacityMinMaxService(),e("body > .bookmify_be_popup_form_wrap").addClass("enable"),this.closersPopup()},duplicateService:function(){var i=this;e(".bookmify_be_service_item .bookmify_be_duplicate").off().on("click",function(a){a.preventDefault();var t=e(this),o=t.closest(".bookmify_be_service_item"),n={action:"ajaxQueryEditService",bookmify_data:o.data("service-id"),duplicate:1};return t.hasClass("loading")||(t.addClass("loading"),o.addClass("loading"),e.ajax({type:"POST",url:i.ajaxurl,cache:!1,data:n,success:function(e){t.removeClass("loading"),o.removeClass("loading"),i.getRequestedServicePopupDuplicate(e)},error:function(){}})),!1})},getRequestedServicePopupDuplicate:function(i){var a=e.parseJSON(i).bookmify_be_data;e("body").addClass("disable_scroll").append(a),e("body > .bookmify_be_popup_form_wrap").addClass("bookmify_be_popup_form_service"),this.imgToSvg(),this.universalTab(),this.reorderGalleryService(),this.addGalleryService(),this.deleteGalleryService(),this.extrasOpener(),this.insertExtras(),this.deleteExtras(),this.reorderExtras(),this.capacityMaxExtras(),this.addGalleryExtras(),this.popperDurationExtras(),this.colorPicker(),this.uploadDeleteMedia(),this.popperCatForService(),this.popperEmployeeForService(),this.popperTaxForService(),this.popperDurationService(),this.saveService(),this.cancelItem(),this.capacityMinMaxService(),e("body > .bookmify_be_popup_form_wrap").addClass("enable"),this.closersPopup()},universalTab:function(){e(".bookmify_be_tab_wrap").each(function(){var i=e(this);i.find("a.bookmify_be_tab_link").on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");var a=e(this).parent(),t=a.index();return a.siblings("li").removeClass("active"),a.addClass("active"),i.find(".bookmify_be_tab_pane").removeClass("active"),e(i.find(".bookmify_be_tab_pane")[t]).addClass("active"),!1})})},deleteService:function(){var i=this;e(".bookmify_service_heading .bookmify_be_delete").off().on("click",function(){var a=e(this),t=a.data("entity-id"),o=a.parents(".bookmify_be_service_item");return a.addClass("clicked"),i.deleteConfirmService(o,t,a),!1})},deleteConfirmService:function(i,a,t){var o=this,n=e("#bookmify_be_confirm");n.addClass("opened service_confirm");var s=e("#bookmify_be_confirm.service_confirm").find("a.yes"),r=e("#bookmify_be_confirm.service_confirm").find("a.no");s.off().on("click",function(s){s.preventDefault(),t.removeClass("clicked"),n.removeClass("opened service_confirm"),t.addClass("loading"),i.addClass("loading");var r={action:"ajaxQueryDeleteService",bookmify_service_id:a};e.ajax({type:"POST",url:o.ajaxurl,cache:!0,data:r,success:function(a){var n=e.parseJSON(a),s=e(".bookmify_be_page_title h3 span.count");return 0===parseInt(n.count)?(s.html(n.number),i.slideUp(500),setTimeout(function(){i.remove()},501),e(".bookmify_be_service_list ul.service_list").removeClass("opened"),o.openerService(),setTimeout(function(){e.iaoAlert({msg:o.alertSuccessIcon+o.serDeleted,type:"success",alertTime:o.iaoAlertTime,position:o.iaoAlertPosition})},501)):(t.removeClass("loading clicked"),i.removeClass("loading"),e.iaoAlert({msg:o.alertWarningIcon+'<span class="error_note">'+o.cantDeleteService+" "+n.count+"</span>",type:"success",alertTime:o.iaoAlertTime,position:o.iaoAlertPosition})),!1}})}),r.on("click",function(){return n.removeClass(),t.removeClass("clicked"),!1})},capacityMinMaxService:function(){e(".min_max_capacity .bookmify_be_quantity").each(function(){var i=e(this),a=i.find('input[type="number"]'),t=i.find(".increase"),o=i.find(".decrease"),n=i.closest(".min_max_capacity"),s=a.attr("min"),r=0;function c(e){var t,o=e.siblings("input");t=parseFloat(a.val())+1;var s=n.find(".max_cap input");t>parseFloat(s.val())&&i.parent().hasClass("min_cap")&&(s.val(t),s.trigger("change")),o.val(t),o.trigger("change")}function l(e){var t,o=e.siblings("input"),r=parseFloat(a.val());if(r<=s)return t=r,!1;t=r-1;var c=n.find(".min_cap input");t<parseFloat(c.val())&&i.parent().hasClass("max_cap")&&(c.val(t),c.trigger("change")),o.val(t),o.trigger("change")}t.on("mousedown touchstart",function(){var i=e(this);r=setInterval(function(){c(i)},150)}).bind("mouseup mouseleave touchend",function(){clearInterval(r)}),t.on("click",function(){var i=e(this);e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),c(i)}),o.on("mousedown touchstart",function(){var i=e(this);r=setInterval(function(){l(i)},150)}).bind("mouseup mouseleave touchend",function(){clearInterval(r)}),o.on("click",function(){var i=e(this);e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),l(i)})})},saveService:function(){var i=this;e(".bookmify_be_popup_form_service .bookmify_be_popup_form_button a.save").off().on("click",function(a){a.preventDefault(),a.stopPropagation();var t=e(this),o=t.closest(".bookmify_be_popup_form_service").find("form"),n=t.closest(".bookmify_be_popup_form_service").data("entity-id");e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");var s=0,r=0,c=0,l=o.find(".bookmify_be_link_tabs"),d=o.find(".bookmify_be_content_tabs");if(o.find(".required_field").each(function(){var a=e(this);""===a.val()&&(a.parent().find(".error_note").remove(),a.parent().addClass("required_error").append(i.errorField),s++,a.parent().parent().parent().hasClass("extra_right")?c++:r++)}),0!==s)return 0!==r?0!==l.find("li.active").index()&&(l.find("li.active").removeClass("active"),d.find(".bookmify_be_tab_pane.active").removeClass("active"),l.find("li:first").addClass("active"),d.find(".bookmify_be_tab_pane:first").addClass("active")):0!==c&&2!==l.find("li.active").index()&&(l.find("li.active").removeClass("active"),d.find(".bookmify_be_tab_pane.active").removeClass("active"),l.find("li:nth-child(3)").addClass("active"),d.find(".bookmify_be_tab_pane:nth-child(3)").addClass("active")),i.scrollToTop(500),!1;if(!n)return n="",t.addClass("await"),i.saveServiceAjax("no",o,n,t),!1;var p=o.find('input[name="service_price"]'),u=p.parent().data("price");return parseFloat(p.val())===parseFloat(u)?(t.addClass("await"),i.saveServiceAjax("no",o,n,t),!1):(i.applyForAllEmployeesConfirm(o,n,t),!1)}),e(".bookmify_be_popup_form_service input.required_field").keyup(function(){var i=e(this);""!==i.val()&&i.parent().hasClass("required_error")&&(i.parent().removeClass("required_error"),i.parent().find(".error_note").remove())})},applyForAllEmployeesConfirm:function(i,a,t){var o=this,n=e("#bookmify_be_confirm_apply");n.addClass("opened");var s=n.find("a.yes"),r=n.find("a.no"),c=n.find("a.cancel");s.off().on("click",function(e){return e.preventDefault(),n.removeClass(),t.addClass("await"),o.saveServiceAjax("yes",i,a,t),!1}),r.on("click",function(){return n.removeClass(),t.addClass("await"),o.saveServiceAjax("no",i,a,t),!1}),c.on("click",function(){return n.removeClass(),!1})},saveServiceAjax:function(i,t,o,n){var s=this,r=t.serialize(),c=[],l={allextra:[]};t.find("ul.extra_service_list li").each(function(){var i={},a=e(this);i.id=a.data("extra-id"),i.att_id=a.find("input[name='extra_img_id']").val(),i.name=a.find("input[name='extra_title']").val(),i.price=a.find("input[name='extra_price']").val(),i.duration=a.find("input[name='extra_duration_sec']").val(),i.max_cap=a.find("input[name='extra_max_cap']").val(),i.desc=a.find("textarea").val(),l.allextra.push(i)}),c.push(l);var d={action:"ajaxQueryInsertOrUpdateService",bookmify_data:r,bookmify_data2:JSON.stringify(c),bookmify_employees_settings:i,serviceID:o,bookmify_page:a.page,bookmify_id:a.id};return e.ajax({type:"POST",url:s.ajaxurl,cache:!0,data:d,success:function(e){n.removeClass("await"),s.getUpdatedServicesList(e,o),s.init()},error:function(){}}),!1},getUpdatedServicesList:function(i,a){var t=this,o=e.parseJSON(i),n=e(".bookmify_be_service_list"),s=e(".bookmify_be_page_title h3 span.count");t.closePopupForm(),e.isNumeric(a)?setTimeout(function(){e.iaoAlert({msg:t.alertSuccessIcon+t.serUpdated,type:"success",alertTime:t.iaoAlertTime,position:t.iaoAlertPosition})},301):setTimeout(function(){e.iaoAlert({msg:t.alertSuccessIcon+t.serAdded,type:"success",alertTime:t.iaoAlertTime,position:t.iaoAlertPosition})},301),n.html(o.bookmify_be_data),s.html(o.number);var r=n.find(".service_list > li");setTimeout(function(){r.each(function(i,a){setTimeout(function(){e(a).addClass("fadeInTop done")},100*i)})},150)},popperCatForService:function(){var i=e(".nano.service_categories");e('.category_holder input[type="text"]').each(function(){var a=e(this);e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),i.on("click",function(e){e.stopPropagation()}),a.on("click",function(a){var t=e(this);if(a.stopPropagation(),i.css({width:t.outerWidth()+"px"}),t.hasClass("input_clicked"))e("input").removeClass("input_clicked"),e(".nano").removeClass("focused");else{e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),t.addClass("input_clicked"),i.addClass("focused");new Popper(t,i,{placement:"bottom-start",onUpdate:function(){i.css({width:t.outerWidth()+"px"})}})}i.find(".nano-content > div").on("click",function(i){i.stopPropagation();var a=e(this).html(),n=e(this).data("id");0===n?t.val(""):t.val(a),t.parent().find('input[type="hidden"]').val(n),o(),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),t.parent().removeClass("required_error"),t.parent().find(".error_note").remove()})}),i.css({width:a.outerWidth()+"px"});var t=a.parent().find(".bot_btn");function o(){" "===a.val()||""===a.val()?t.removeClass("opened"):t.addClass("opened")}t.on("click",function(){a.val(""),a.parent().find('input[type="hidden"]').val(""),t.removeClass("opened"),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),o()})},popperEmployeeForService:function(){var i=e(".nano.service_employees"),a=e('.provider_holder input[type="text"]'),t=i.find('input[type="checkbox"]');function o(i){var a=i,o=a.attr("data-placeholder"),n=a.siblings(".bot_btn");n.off().on("click",function(){a.siblings('[name="service_provider_ids"]').val(""),a.siblings(".bookmify_be_new_value").html(""),t.prop("checked",!1),a.attr("placeholder",o),n.removeClass("opened"),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")})}function n(e){var i=e,a=i.siblings('input[name="service_provider_ids"]'),t=i.siblings(".bot_btn");" "===a.val()||""===a.val()?t.removeClass("opened"):t.addClass("opened")}a.each(function(){var i=e(this);n(i),o(i)}),a.on("click",function(a){a.stopPropagation();var s=e(this),r=s.closest(".bookmify_be_popup_form_service").data("entity-id"),c=s.siblings('[name="service_provider_ids"]').val().split(","),l=1;t.prop("checked",!1),i.attr("data-id",r),e.each(c,function(e,a){l++,i.find('input[type="checkbox"][value="'+a+'"]').prop("checked",!0)}),t.length===l&&(i.find(".bookmify_be_check_all_items").prop("checked",!0),i.find("li").addClass("checked"));var d=e(".nano.service_employees");if(s.hasClass("input_clicked"))e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");else{e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),s.addClass("input_clicked"),d.addClass("focused"),d.css({width:s.outerWidth()+"px"});new Popper(s,d,{placement:"bottom-start",onUpdate:function(){d.css({width:s.outerWidth()+"px"})}})}!function(a){i.find("ul.employees_nano_list li").off().on("click",function(){var s,r,c,l=e(this).index(),d=e(this).find('input[type="checkbox"]');d.is(":checked")?0===l?t.prop("checked",!1):(d.prop("checked",!1),i.find('ul.employees_nano_list li:first input[type="checkbox"]').prop("checked",!1)):0===l?t.prop("checked",!0):(d.prop("checked",!0),i.find('ul.employees_nano_list li:first input[type="checkbox"]').prop("checked",!1)),n(a),function(a){var t=[];i.find("ul.employees_nano_list li").each(function(){var i=e(this),a=i.find('input[name="employee_id"]').val();0!==i.index()&&(i.find('input[type="checkbox"]').is(":checked")?(t=e.grep(t,function(e){return e!==a}),i.addClass("checked"),t.push(i.find('input[name="employee_id"]').val())):(i.removeClass("checked"),t=e.grep(t,function(e){return e!==a})))});var s=a.attr("data-placeholder");if(e.isEmptyObject(t))a.attr("placeholder",s),a.siblings(".bookmify_be_new_value").html("");else{var r="";if(a.attr("placeholder",""),t.length>1){var c=i.find("ul.employees_nano_list li").length-1;r='<span class="number">'+t.length+" / "+c+"</span>"}var l='<span class="text">'+i.find("input[value="+t[0]+"]").closest("li").find("span.name").html()+"</span>";a.siblings(".bookmify_be_new_value").html("").html(l+r)}a.parent().find('input[name="service_provider_ids"]').val("").val(t),n(a),o(a)}(a),o(a),s=i.find(".employees_nano_list li").not(":first").find('input[type="checkbox"]'),r=i.find(".employees_nano_list li").not(":first").find('input[type="checkbox"]:checked'),c=i.find('.employees_nano_list li:first input[type="checkbox"]'),r.length===s.length?c.prop("checked",!0):c.prop("checked",!1)})}(s)}),e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),e(".nano.service_employees").on("click",function(e){e.stopPropagation()}),i.on("click",function(e){e.stopPropagation()}),o(a)},popperTaxForService:function(){var i=e(".nano.service_taxes"),a=e('.bookmify_be_popup_form_wrap .tax_holder input[type="text"]'),t=i.find('input[type="checkbox"]');function o(i){var a=i,o=a.attr("data-placeholder"),n=a.siblings(".bot_btn");n.off().on("click",function(){a.siblings('[name="service_tax_ids"]').val(""),a.siblings(".bookmify_be_new_value").html(""),t.prop("checked",!1),a.attr("placeholder",o),n.removeClass("opened"),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")})}function n(e){var i=e,a=i.siblings('input[name="service_tax_ids"]'),t=i.siblings(".bot_btn");" "===a.val()||""===a.val()?t.removeClass("opened"):t.addClass("opened")}a.each(function(){var i=e(this);n(i),o(i)}),a.on("click",function(a){a.stopPropagation();var s=e(this),r=s.closest(".bookmify_be_popup_form_service").data("entity-id"),c=s.siblings('[name="service_tax_ids"]').val().split(","),l=1;t.prop("checked",!1),i.attr("data-id",r),e.each(c,function(e,a){l++,i.find('input[type="checkbox"][value="'+a+'"]').prop("checked",!0)}),t.length===l&&(i.find(".bookmify_be_check_all_items").prop("checked",!0),i.find("li").addClass("checked"));var d=e(".nano.service_taxes");if(s.hasClass("input_clicked"))e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");else{e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),s.addClass("input_clicked"),d.addClass("focused"),d.css({width:s.outerWidth()+"px"});new Popper(s,d,{placement:"bottom-start",onUpdate:function(){d.css({width:s.outerWidth()+"px"})}})}!function(a){i.find("ul.taxes_nano_list li").off().on("click",function(){var s,r,c,l=e(this).index(),d=e(this).find('input[type="checkbox"]');d.is(":checked")?0===l?t.prop("checked",!1):(d.prop("checked",!1),i.find('ul.taxes_nano_list li:first input[type="checkbox"]').prop("checked",!1)):0===l?t.prop("checked",!0):(d.prop("checked",!0),i.find('ul.taxes_nano_list li:first input[type="checkbox"]').prop("checked",!1)),n(a),function(a){var t=[];i.find("ul.taxes_nano_list li").each(function(){var i=e(this),a=i.find('input[name="tax_id"]').val();0!==i.index()&&(i.find('input[type="checkbox"]').is(":checked")?(t=e.grep(t,function(e){return e!==a}),i.addClass("checked"),t.push(i.find('input[name="tax_id"]').val())):(i.removeClass("checked"),t=e.grep(t,function(e){return e!==a})))});var s=a.attr("data-placeholder");if(e.isEmptyObject(t))a.attr("placeholder",s),a.siblings(".bookmify_be_new_value").html("");else{var r="";if(a.attr("placeholder",""),t.length>1){var c=i.find("ul.taxes_nano_list li").length-1;r='<span class="number">'+t.length+" / "+c+"</span>"}var l='<span class="text">'+i.find("input[value="+t[0]+"]").closest("li").find("span.name").html()+"</span>";a.siblings(".bookmify_be_new_value").html("").html(l+r)}a.parent().find('input[name="service_tax_ids"]').val("").val(t),n(a),o(a)}(a),o(a),s=i.find(".taxes_nano_list li").not(":first").find('input[type="checkbox"]'),r=i.find(".taxes_nano_list li").not(":first").find('input[type="checkbox"]:checked'),c=i.find('.taxes_nano_list li:first input[type="checkbox"]'),r.length===s.length?c.prop("checked",!0):c.prop("checked",!1)})}(s)}),e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),e(".nano.service_taxes").on("click",function(e){e.stopPropagation()}),i.on("click",function(e){e.stopPropagation()}),o(a)},popperDurationService:function(){var i=e(".nano.buffer_time");e('.duration_buffer input[type="text"]').each(function(){var a=e(this),t=e(".nano.buffer_time."+a.parent().attr("class"));e(window).on("click",function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),i.on("click",function(e){e.stopPropagation()}),a.off().on("click",function(i){var a=e(this);if(i.stopPropagation(),a.hasClass("input_clicked"))e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");else{e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),a.addClass("input_clicked"),t.addClass("focused");new Popper(a,t,{placement:"bottom-start",onUpdate:function(){t.css({width:a.outerWidth()+"px"})}});t.css({width:a.outerWidth()+"px"})}t.find(".nano-content > div").on("click",function(i){i.stopPropagation();var t=e(this).html(),o=e(this).data("sec");a.val(t),a.parent().find('input[type="hidden"]').val(o),s(),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked"),a.parent().removeClass("required_error"),a.parent().find(".error_note").remove()})}),t.css({width:a.outerWidth()+"px"});var o=a.parent().find(".bot_btn"),n=a.parent().find('input[type="hidden"]');function s(){"duration"!==a.parent().attr("class")&&(" "===a.val()||""===a.val()?o.removeClass("opened"):o.addClass("opened"))}o.on("click",function(){a.val(""),n.val(""),o.removeClass("opened"),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked")}),s()})},colorPicker:function(){e(".bookmify_be_popup_form_service .bookmify_color_picker").each(function(){var i=e(this);i.wpColorPicker({width:200,change:function(){var e=i.closest(".bookmify_be_service_item").find(".img_and_color_holder .color_info"),a=i.closest(".bookmify_be_service_item").find(".img_and_color_holder .img_holder"),t=i.wpColorPicker("color");e.css({backgroundColor:t}),a.css({backgroundColor:t})}})})},uploadDeleteMedia:function(){e(".bookmify_thumb_edit").off().on("click",function(i){i.preventDefault(),i.stopPropagation(),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");var a=e(this).parents("form.bookmify_be_main_form"),t=a.parent().siblings().find(".img_holder"),o=a.find('input[class="bookmify_be_img_id"]'),n=a.find(".bookmify_thumb_wrap"),s=a.find(".bookmify_thumb_remove"),r="",c="",l=wp.media({library:{type:"image"},multiple:!1});return l.on("select",function(){var i=l.state().get("selection").toJSON();i.length&&(r=void 0!==i[0].sizes.thumbnail?i[0].sizes.thumbnail.url:i[0].url,c=void 0!==i[0].sizes.large?i[0].sizes.large.url:i[0].url,o.val(i[0].id),n.addClass("has_image").css({"background-image":"url("+c+")"}),t.css({"background-image":"url("+r+")"}),e(this).hide(),s.show())}),l.open(),!1}),e(".bookmify_thumb_remove a").on("click",function(i){i.preventDefault(),i.stopPropagation(),e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");var a=e(this).parents("form.bookmify_be_main_form"),t=a.parent().siblings().find(".img_holder"),o=a.find('input[class="bookmify_be_img_id"]'),n=a.find(".bookmify_thumb_wrap");return o.val(""),n.removeClass("has_image").css({"background-image":"none"}),t.css({"background-image":"none"}),e(this).parent().hide(),!1})},closerButton:function(){var i=this;e(".bookmify_be_popup_form_wrap.enable").find("span.closer").on("click",function(){i.closePopupForm()})},closerEsc:function(){e(document).keyup(function(e){e.key})},closersPopup:function(){this.closerEsc(),this.closerButton()},closePopupForm:function(){e(".nano").removeClass("focused"),e("input").removeClass("input_clicked");var i=e(".bookmify_be_popup_form_wrap.enable");e("body").removeClass("disable_scroll"),i.removeClass("enable"),setTimeout(function(){i.remove()},300)},simultaneouslyTyping:function(){var i=this;e('ul.extra_service_list input[name="extra_title"]').keyup(function(){var i=e(this).val();e(this).closest(".bookmify_be_list_item").find(".bookmify_be_list_item_header .e_top").text(i)}),e('ul.extra_service_list input[name="extra_price"]').keyup(function(){var a=e(this).val();e(this).closest(".bookmify_be_list_item").find(".bookmify_be_list_item_header .extra_price, .bookmify_be_list_item_header .e_price").text(i.integerToPriceFormatFunction(a))})},integerToPriceFormatFunction:function(i){var a,t,o,n,s=e(".bookmify_be_price_hidden"),r=s.find(".currency_format").val(),c=s.find(".currency_position").val(),l=s.find(".price_format").val(),d=parseFloat(s.find(".price_decimal").val());switch(l){default:case"cd":o=".",n=",";break;case"dc":o=",",n=".";break;case"sd":o=".",n=" ";break;case"sc":o=",",n=" "}isNaN(d=Math.abs(d))&&(d=2),(t=(a=parseInt(i=(+i||0).toFixed(d))+"").length)>3?t%=3:t=0;var p=(t?a.substr(0,t)+n:"")+a.substr(t).replace(/(\d{3})(?=\d)/g,"$1"+n)+(d?o+Math.abs(i-a).toFixed(d).replace(/-/,0).slice(2):"");switch(c){default:case"left":p=r+p;break;case"lspace":p=r+" "+p;break;case"right":p+=r;break;case"rspace":p=p+" "+r}return p},doFilter:function(){var i=this;e("ul.bookmify_be_pagination.service a").on("click",function(t){t.preventDefault();var o=e(this),n=o.parent(),s=o.data("page"),r=0;return n.hasClass("prev")?(s=o.parent().parent().find("li.active a").data("page")-1,r=1):n.hasClass("next")&&(s=o.parent().parent().find("li.active a").data("page")+1,r=1),n.hasClass("active")||(a.page=s,i.filterAjaxCall()),1===r&&(a.page=s,i.filterAjaxCall()),!1}),e(".bookmify_be_service_page .cat_list_wrap .title a").off().on("click",function(t){t.preventDefault();var o=e(this);return e(".bookmify_be_service_page .cat_list_wrap ul li").removeClass("active"),o.hasClass("active")||(o.addClass("active"),a.id="all",a.page=1,i.filterAjaxCall()),!1}),e(".bookmify_be_service_page .cat_list_wrap ul li:not(.opened) div.left_part .cat_name").off().on("click",function(t){t.preventDefault();var o=e(this).closest("li"),n=o.data("category-id");return e(".bookmify_be_service_page .cat_list_wrap .title a").removeClass("active"),o.hasClass("active")||(e(".bookmify_be_service_page .cat_list_wrap ul li").removeClass("active"),o.addClass("active"),a.id=n,a.page=1,i.filterAjaxCall()),!1})},filterAjaxCall:function(){var i=this,t={action:"ajaxFilterServiceList",bookmify_page:a.page,bookmify_id:a.id};e.ajax({type:"POST",url:i.ajaxurl,cache:!0,data:t,success:function(e){i.getFilteredServicesList(e)},error:function(){}})},getFilteredServicesList:function(i){var a=e.parseJSON(i),t=e(".bookmify_be_service_list");t.html(a.bookmify_be_data);var o=t.find(".service_list > li");setTimeout(function(){o.each(function(i,a){setTimeout(function(){e(a).addClass("fadeInTop done")},100*i)})},150),this.init()},scrollToTop:function(i){e(".bookmify_be_popup_form_wrap").animate({scrollTop:0},i)},cancelItem:function(){var i=this;e(".bookmify_be_popup_form_button a.cancel").off().on("click",function(){return i.closePopupForm(),!1})}};e(document).ready(function(){t.init()})}(jQuery);